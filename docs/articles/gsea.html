<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Gene Set Enrichment Analysis • SPATA2</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Gene Set Enrichment Analysis">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SPATA2</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/installation.html">Installation</a>
</li>
<li>
  <a href="../articles/spata-data.html">SPATAData</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tutorials

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Initiating a SPATA2 object</li>
    <li>
      <a href="../articles/initiation-and-preprocessing-customized.html">Initiation &amp; Preprocessing with individual data</a>
    </li>
    <li>
      <a href="../articles/initiation-and-preprocessing-merfish.html">Initiation &amp; Preprocessing with MERFISH data</a>
    </li>
    <li>
      <a href="../articles/initiation-and-preprocessing-visium.html">Initiation &amp; Preprocessing with Visium data</a>
    </li>
    <li>
      <a href="../articles/initiation-and-preprocessing-visium-hd.html">Initiation &amp; Preprocessing with VisiumHD data</a>
    </li>
    <li class="dropdown-header">Basic Manipulation of a SPATA2 object</li>
    <li>
      <a href="../articles/adding-data.html">Adding Data to SPATA2 objects</a>
    </li>
    <li>
      <a href="../articles/package-compatibility.html">Platform Compatibility</a>
    </li>
    <li>
      <a href="../articles/molecular-variables.html">Molecular Variables</a>
    </li>
    <li>
      <a href="../articles/image-handling.html">Image Handling</a>
    </li>
    <li>
      <a href="../articles/spatial-segmentation.html">Spatial Segmentation</a>
    </li>
    <li class="dropdown-header">Implemented Algorithms &amp; Concepts</li>
    <li>
      <a href="../articles/cnv.html">Copy Number Variations</a>
    </li>
    <li>
      <a href="../articles/clustering.html">Clustering</a>
    </li>
    <li>
      <a href="../articles/dimensional-reduction.html">Dimensional Reduction</a>
    </li>
    <li>
      <a href="../articles/dea.html">Differential Expression</a>
    </li>
    <li>
      <a href="../articles/gsea.html">Gene Set Enrichment</a>
    </li>
    <li>
      <a href="../articles/spatial-measures.html">Spatial Measures</a>
    </li>
    <li class="dropdown-header">Spatial Gradient Screening</li>
    <li>
      <a href="../articles/creating-spatial-annotations.html">Creating Spatial Annotations</a>
    </li>
    <li>
      <a href="../articles/using-spatial-annotations.html">Using Spatial Annotations</a>
    </li>
    <li>
      <a href="../articles/spatial-annotation-screening.html">Spatial Annotation Screening</a>
    </li>
    <li>
      <a href="../articles/creating-spatial-trajectories.html">Creating Spatial Trajectories</a>
    </li>
    <li>
      <a href="../articles/spatial-trajectory-screening.html">Spatial Trajectory Screening</a>
    </li>
    <li class="dropdown-header">Visualization</li>
    <li>
      <a href="../articles/plotting-surface.html">Surface Plotting</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/newslog.html">Newslog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Gene Set Enrichment Analysis</h1>
            
      

      <div class="hidden name"><code>gsea.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">1. Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Make sure to be familiar with the tutorials about <a href="dea.html">Differential Expression Analysis</a> and <a href="molecular-variables.html">Molecular Variables</a>. For a deeper
into the results of the DEA one can look for gene sets that are enriched
in the proposed clustering or created based on histology.
<code>SPATA2</code> implements the <a href="https://github.com/montilab/hypeR" class="external-link"><code>hypeR</code></a> package
which uses hypergeometric testing for enriched gene sets.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load required packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://themilolab.com/" class="external-link">SPATA2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># load SPATA2 inbuilt example data</span></span>
<span><span class="va">object_t269</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/loadExampleObject.html">loadExampleObject</a></span><span class="op">(</span><span class="st">"UKF269T"</span>, process <span class="op">=</span> <span class="cn">TRUE</span>, meta <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot histology </span></span>
<span><span class="fu"><a href="../reference/plotSurface.html">plotSurface</a></span><span class="op">(</span><span class="va">object_t269</span>, color_by <span class="op">=</span> <span class="st">"histology"</span>, pt_clrp <span class="op">=</span> <span class="st">"npg"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot bayes space cluster</span></span>
<span><span class="fu"><a href="../reference/plotSurface.html">plotSurface</a></span><span class="op">(</span><span class="va">object_t269</span>, color_by <span class="op">=</span> <span class="st">"bayes_space"</span>, pt_clrp <span class="op">=</span> <span class="st">"uc"</span><span class="op">)</span></span></code></pre></div>
<p><img src="gsea_files/figure-html/unnamed-chunk-2-1.png" width="50%"><img src="gsea_files/figure-html/unnamed-chunk-2-2.png" width="50%"></p>
</div>
<div class="section level2">
<h2 id="running-gene-set-enrichment-analysis-gsea">2. Running Gene Set Enrichment Analysis (GSEA)<a class="anchor" aria-label="anchor" href="#running-gene-set-enrichment-analysis-gsea"></a>
</h2>
<p>The function <code><a href="../reference/runGSEA.html">runGSEA()</a></code> conducts the computation. It
requires the results from <code><a href="../reference/runDEA.html">runDEA()</a></code> which conducts the
differential expressiona nalysis. By default, the function uses all gene
sets that are saved in the <code>SPATA2</code> object. If there are gene
sets that you don’t want to test against you can provide a subsetted
list of gene sets. The default example object <code>object_t269</code>
has been created with <code><a href="../reference/initiateSpataObjectVisium.html">initiateSpataObjectVisium()</a></code> and
contains a variety of gene sets of multiple classes (Hallmark, Biocarta,
etc.) marked with a corresponding prefix like <em>HM</em> or
<em>BC</em>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gs_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getSignatureList.html">getGeneSetList</a></span><span class="op">(</span><span class="va">object_t269</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">gs_list</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $BC_41BB_PATHWAY</span></span>
<span><span class="co">##  [1] "IFNG"    "TNFSF9"  "IL4"     "NFKBIA"  "TNFRSF9" "IL2"     "MAP4K5" </span></span>
<span><span class="co">##  [8] "MAPK8"   "MAP3K5"  "CHUK"    "MAPK14"  "RELA"    "TRAF2"   "ATF2"   </span></span>
<span><span class="co">## [15] "IKBKB"   "NFKB1"   "MAP3K1"  "JUN"    </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $BC_ACE2_PATHWAY</span></span>
<span><span class="co">##  [1] "REN"    "COL4A1" "AGT"    "CMA1"   "COL4A6" "ACE2"   "ACE"    "COL4A5"</span></span>
<span><span class="co">##  [9] "AGTR2"  "AGTR1"  "COL4A2" "COL4A3" "COL4A4"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $BC_ACETAMINOPHEN_PATHWAY</span></span>
<span><span class="co">## [1] "CYP1A2" "CYP2E1" "PTGS2"  "PTGS1"  "NR1I3" </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $BC_ACH_PATHWAY</span></span>
<span><span class="co">##  [1] "FASLG"  "PIK3CG" "RAPSN"  "PIK3R1" "FOXO3"  "YWHAH"  "CHRNG"  "CHRNB1"</span></span>
<span><span class="co">##  [9] "BAD"    "PTK2B"  "TERT"   "MUSK"   "AKT1"   "PIK3CA"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $BC_ACTINY_PATHWAY</span></span>
<span><span class="co">##  [1] "ACTA1"  "WASF1"  "PSMA7"  "NTRK1"  "RAC1"   "WASF2"  "ABI2"   "NCK1"  </span></span>
<span><span class="co">##  [9] "PIR"    "NCKAP1" "WASF3"  "WASL"  </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $BC_AGPCR_PATHWAY</span></span>
<span><span class="co">##  [1] "GRK4"    "GNAS"    "PRKACG"  "PRKAR1A" "PRKAR2B" "PRKCB"   "PRKACB" </span></span>
<span><span class="co">##  [8] "ARRB1"   "PRKAR1B" "PRKCA"   "PRKAR2A"</span></span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">gs_list</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 11654</span></span></code></pre>
<p>For the sake of clarity, this example only uses Biocarta (BC) and
Hallmark (HM) gene sets.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># subset gene sets that start with HM or BC</span></span>
<span><span class="va">gs_list_sub</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getSignatureList.html">getGeneSetList</a></span><span class="op">(</span><span class="va">object_t269</span>, class <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BC"</span>, <span class="st">"HM"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">gs_list_sub</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 339</span></span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">gs_list_sub</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $HM_NOTCH_SIGNALING</span></span>
<span><span class="co">##  [1] "JAG1"    "NOTCH3"  "NOTCH2"  "APH1A"   "HES1"    "CCND1"   "FZD1"   </span></span>
<span><span class="co">##  [8] "PSEN2"   "FZD7"    "DTX1"    "DLL1"    "FZD5"    "MAML2"   "NOTCH1" </span></span>
<span><span class="co">## [15] "PSENEN"  "WNT5A"   "CUL1"    "WNT2"    "DTX4"    "SAP30"   "PPARD"  </span></span>
<span><span class="co">## [22] "KAT2A"   "HEYL"    "SKP1"    "RBX1"    "TCF7L2"  "ARRB1"   "LFNG"   </span></span>
<span><span class="co">## [29] "PRKCA"   "DTX2"    "ST3GAL6" "FBXW11" </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $BC_MEF2D_PATHWAY</span></span>
<span><span class="co">##  [1] "HDAC2"  "HDAC1"  "CALM1"  "MEF2D"  "CAPN2"  "NFATC2" "PPP3CA" "PRKCB" </span></span>
<span><span class="co">##  [9] "CALM2"  "PPP3CB" "CAPNS1" "CALM3"  "CABIN1" "EP300"  "PRKCA"  "NFATC1"</span></span>
<span><span class="co">## [17] "CAPNS2" "PPP3CC"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $BC_HSWI_SNF_PATHWAY</span></span>
<span><span class="co">##  [1] "SMARCD1" "NF1"     "NR3C1"   "SMARCC2" "SMARCA4" "ARID1A"  "SMARCC1"</span></span>
<span><span class="co">##  [8] "ACTB"    "SMARCB1" "TBP"     "GTF2A1"  "SMARCE1"</span></span></code></pre>
<p>Use argument <code>signatures</code> if you want to run GSEA only on
a subset of gene sets. Keep it empty if you want to test against all
gene sets stored in the <code>SPATA2</code> object_t269.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">object_t269</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/runGSEA.html">runGSEA</a></span><span class="op">(</span></span>
<span>    object <span class="op">=</span> <span class="va">object_t269</span>,</span>
<span>    across <span class="op">=</span> <span class="st">"histology"</span>, </span>
<span>    background <span class="op">=</span> <span class="fl">21563</span>, </span>
<span>    signatures <span class="op">=</span> <span class="va">gs_list_sub</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="extracting-results">3. Extracting results<a class="anchor" aria-label="anchor" href="#extracting-results"></a>
</h2>
<p>The results can be manually extracted via the following functions.
<code><a href="../reference/getGseaResults.html">getGseaResults()</a></code> extracts a list of <code>hypeR</code>
object_t269s - on for each group. <code>getGseaResultsDf()</code>
extracts a data.frame that results from merging the data of all
<code>hypeR</code> object_t269s together. The group belonging of each
gene set is saved in the variable/column that is named according to the
grouping variable - here <em>histology</em>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/getGseaDf.html">getGseaDf</a></span><span class="op">(</span></span>
<span>  object <span class="op">=</span> <span class="va">object_t269</span>, </span>
<span>  across <span class="op">=</span> <span class="st">"histology"</span>,</span>
<span>  method_de <span class="op">=</span> <span class="st">"wilcox"</span>, </span>
<span>  n_gsets <span class="op">=</span> <span class="fl">3</span> <span class="co"># extract top 20 most significant gene sets</span></span>
<span><span class="op">)</span> </span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 9 × 10</span></span></span>
<span><span class="co">## <span style="color: #949494;"># Groups:   histology [3]</span></span></span>
<span><span class="co">##   histology   label     pval      fdr signature geneset overlap background hits </span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> tumor       HM_E… 8.60<span style="color: #949494;">e</span><span style="color: #BB0000;">-43</span> 1   <span style="color: #949494;">e</span><span style="color: #BB0000;">-38</span>      <span style="text-decoration: underline;">5</span>082     200     143      <span style="text-decoration: underline;">20</span>000 AURK…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> tumor       HM_I… 3.60<span style="color: #949494;">e</span><span style="color: #BB0000;">-35</span> 2.10<span style="color: #949494;">e</span><span style="color: #BB0000;">-31</span>      <span style="text-decoration: underline;">5</span>082     196     132      <span style="text-decoration: underline;">20</span>000 STAT…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> tumor       HM_G… 1.3 <span style="color: #949494;">e</span><span style="color: #BB0000;">-30</span> 5.20<span style="color: #949494;">e</span><span style="color: #BB0000;">-27</span>      <span style="text-decoration: underline;">5</span>082     196     126      <span style="text-decoration: underline;">20</span>000 AURK…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> transition  MF.G… 2.40<span style="color: #949494;">e</span><span style="color: #BB0000;">- 9</span> 2.70<span style="color: #949494;">e</span><span style="color: #BB0000;">- 5</span>      <span style="text-decoration: underline;">1</span>192     200      36      <span style="text-decoration: underline;">20</span>000 CHD1…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> transition  BP.G… 6   <span style="color: #949494;">e</span><span style="color: #BB0000;">- 9</span> 2.8 <span style="color: #949494;">e</span><span style="color: #BB0000;">- 5</span>      <span style="text-decoration: underline;">1</span>192     856      94      <span style="text-decoration: underline;">20</span>000 TANK…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> transition  HM_E… 8.40<span style="color: #949494;">e</span><span style="color: #BB0000;">- 9</span> 2.8 <span style="color: #949494;">e</span><span style="color: #BB0000;">- 5</span>      <span style="text-decoration: underline;">1</span>192     200      35      <span style="text-decoration: underline;">20</span>000 DNMT…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">7</span> infiltrated CC.G… 3.80<span style="color: #949494;">e</span><span style="color: #BB0000;">-54</span> 4.50<span style="color: #949494;">e</span><span style="color: #BB0000;">-50</span>      <span style="text-decoration: underline;">1</span>950    <span style="text-decoration: underline;">1</span>332     315      <span style="text-decoration: underline;">20</span>000 CDH8…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">8</span> infiltrated BP.G… 1.90<span style="color: #949494;">e</span><span style="color: #BB0000;">-42</span> 1.10<span style="color: #949494;">e</span><span style="color: #BB0000;">-38</span>      <span style="text-decoration: underline;">1</span>950     733     198      <span style="text-decoration: underline;">20</span>000 CDH8…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">9</span> infiltrated CC.G… 1.4 <span style="color: #949494;">e</span><span style="color: #BB0000;">-32</span> 5.40<span style="color: #949494;">e</span><span style="color: #BB0000;">-29</span>      <span style="text-decoration: underline;">1</span>950    <span style="text-decoration: underline;">1</span>317     266      <span style="text-decoration: underline;">20</span>000 HDAC…</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 1 more variable: overlap_perc &lt;dbl&gt;</span></span></span></code></pre>
</div>
<div class="section level2">
<h2 id="plotting-results">4. Plotting results<a class="anchor" aria-label="anchor" href="#plotting-results"></a>
</h2>
<p>Gene set enrichment results can be visualized via dot plots. This can
be either done by group with <code>by_group = TRUE</code> or merged for
all groups. Figure 2 visualizes the enrichment for cluster 0 and 5
highlighting the hypoxia associated activity in this area.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotGseaDotPlot.html">plotGseaDotPlot</a></span><span class="op">(</span></span>
<span>  object <span class="op">=</span> <span class="va">object_t269</span>,</span>
<span>  across <span class="op">=</span> <span class="st">"histology"</span>,</span>
<span>  across_subset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tumor"</span>, <span class="st">"infiltrated"</span><span class="op">)</span>,</span>
<span>  n_gsets <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  by_group <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>  transform_with <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fdr <span class="op">=</span> <span class="va">log10</span><span class="op">)</span>,</span>
<span>  nrow <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="gsea_files/figure-html/unnamed-chunk-7-1.png" width="100%"></p>
<p>Using <code>by_group = FALSE</code>, the results are merged to one
plot.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotGseaDotPlot.html">plotGseaDotPlot</a></span><span class="op">(</span></span>
<span>  object <span class="op">=</span> <span class="va">object_t269</span>,</span>
<span>  across <span class="op">=</span> <span class="st">"histology"</span>,</span>
<span>  color_by <span class="op">=</span> <span class="st">"histology"</span>,</span>
<span>  n_gsets <span class="op">=</span> <span class="fl">7</span>,</span>
<span>  pt_alpha <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  transform_with <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fdr <span class="op">=</span> <span class="va">log10</span><span class="op">)</span>,</span>
<span>  by_group <span class="op">=</span> <span class="cn">FALSE</span> <span class="co"># merge in one plot</span></span>
<span><span class="op">)</span> </span></code></pre></div>
<p><img src="gsea_files/figure-html/unnamed-chunk-8-1.png" width="100%"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Jan Kueckelhaus, Dieter-Henrik Heiland.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer>
</div>






  </body>
</html>

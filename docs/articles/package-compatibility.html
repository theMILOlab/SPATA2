<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Package Compatibility • SPATA2</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Package Compatibility">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SPATA2</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/installation.html">Installation</a>
</li>
<li>
  <a href="../articles/spata-data.html">SPATAData</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tutorials

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Initiating a SPATA2 object</li>
    <li>
      <a href="../articles/initiation-and-preprocessing-customized.html">Initiation &amp; Preprocessing with individual data</a>
    </li>
    <li>
      <a href="../articles/initiation-and-preprocessing-merfish.html">Initiation &amp; Preprocessing with MERFISH data</a>
    </li>
    <li>
      <a href="../articles/initiation-and-preprocessing-visium.html">Initiation &amp; Preprocessing with Visium data</a>
    </li>
    <li>
      <a href="../articles/initiation-and-preprocessing-visium-hd.html">Initiation &amp; Preprocessing with VisiumHD data</a>
    </li>
    <li class="dropdown-header">Basic Manipulation of a SPATA2 object</li>
    <li>
      <a href="../articles/adding-data.html">Adding Data to SPATA2 objects</a>
    </li>
    <li>
      <a href="../articles/package-compatibility.html">Platform Compatibility</a>
    </li>
    <li>
      <a href="../articles/molecular-variables.html">Molecular Variables</a>
    </li>
    <li>
      <a href="../articles/image-handling.html">Image Handling</a>
    </li>
    <li>
      <a href="../articles/spatial-segmentation.html">Spatial Segmentation</a>
    </li>
    <li class="dropdown-header">Implemented Algorithms &amp; Concepts</li>
    <li>
      <a href="../articles/cnv.html">Copy Number Variations</a>
    </li>
    <li>
      <a href="../articles/clustering.html">Clustering</a>
    </li>
    <li>
      <a href="../articles/dimensional-reduction.html">Dimensional Reduction</a>
    </li>
    <li>
      <a href="../articles/dea.html">Differential Expression</a>
    </li>
    <li>
      <a href="../articles/gsea.html">Gene Set Enrichment</a>
    </li>
    <li>
      <a href="../articles/spatial-measures.html">Spatial Measures</a>
    </li>
    <li class="dropdown-header">Spatial Gradient Screening</li>
    <li>
      <a href="../articles/creating-spatial-annotations.html">Creating Spatial Annotations</a>
    </li>
    <li>
      <a href="../articles/using-spatial-annotations.html">Using Spatial Annotations</a>
    </li>
    <li>
      <a href="../articles/spatial-annotation-screening.html">Spatial Annotation Screening</a>
    </li>
    <li>
      <a href="../articles/creating-spatial-trajectories.html">Creating Spatial Trajectories</a>
    </li>
    <li>
      <a href="../articles/spatial-trajectory-screening.html">Spatial Trajectory Screening</a>
    </li>
    <li class="dropdown-header">Visualization</li>
    <li>
      <a href="../articles/plotting-surface.html">Surface Plotting</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/newslog.html">Newslog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Package Compatibility</h1>
            
      

      <div class="hidden name"><code>package-compatibility.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">1. Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This tutorial demonstrates how to convert Seurat or AnnData/h5ad
object to SPATA2. SPATA2 provides the convenient function
<code><a href="../reference/asSPATA2.html">asSPATA2()</a></code> to load objects from the mentioned packages.</p>
</div>
<div class="section level2">
<h2 id="seurat">2. Seurat<a class="anchor" aria-label="anchor" href="#seurat"></a>
</h2>
<p>First, an exemplary 10X Visium dataset from the mouse brain is loaded
using SeuratData. We are following the <a href="https://satijalab.org/seurat/articles/spatial_vignette.html" class="external-link">Seurat
tutorial</a> in the following.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load packages for this tutorial </span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://satijalab.org/seurat" class="external-link">Seurat</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.satijalab.org/seurat" class="external-link">SeuratData</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://themilolab.com/" class="external-link">SPATA2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">SPATAData</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create an example Seurat object</span></span>
<span><span class="co"># install and load data with SeuratData</span></span>
<span><span class="fu"><a href="https://satijalab.org/seurat/reference/InstallData.html" class="external-link">InstallData</a></span><span class="op">(</span><span class="st">"stxBrain"</span><span class="op">)</span></span>
<span><span class="va">brain</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/LoadData.html" class="external-link">LoadData</a></span><span class="op">(</span><span class="st">"stxBrain"</span>, type <span class="op">=</span> <span class="st">"anterior1"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># process</span></span>
<span><span class="va">brain</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/NormalizeData.html" class="external-link">NormalizeData</a></span><span class="op">(</span><span class="va">brain</span>, assay <span class="op">=</span> <span class="st">"Spatial"</span><span class="op">)</span></span>
<span><span class="va">brain</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/SCTransform.html" class="external-link">SCTransform</a></span><span class="op">(</span><span class="va">brain</span>, assay <span class="op">=</span> <span class="st">"Spatial"</span><span class="op">)</span></span>
<span><span class="va">brain</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/RunPCA.html" class="external-link">RunPCA</a></span><span class="op">(</span><span class="va">brain</span>, assay <span class="op">=</span> <span class="st">"SCT"</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">brain</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/RunUMAP.html" class="external-link">RunUMAP</a></span><span class="op">(</span><span class="va">brain</span>, reduction <span class="op">=</span> <span class="st">"pca"</span>, dims <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span></span>
<span></span>
<span><span class="va">brain</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/FindNeighbors.html" class="external-link">FindNeighbors</a></span><span class="op">(</span><span class="va">brain</span>, reduction <span class="op">=</span> <span class="st">"pca"</span>, dims <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span></span>
<span><span class="va">brain</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/FindClusters.html" class="external-link">FindClusters</a></span><span class="op">(</span><span class="va">brain</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># left plot</span></span>
<span><span class="fu"><a href="https://satijalab.org/seurat/reference/SpatialPlot.html" class="external-link">SpatialPlot</a></span><span class="op">(</span><span class="va">brain</span>, group.by <span class="op">=</span> <span class="st">"seurat_clusters"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># right plot</span></span>
<span><span class="fu"><a href="https://satijalab.org/seurat/reference/DimPlot.html" class="external-link">DimPlot</a></span><span class="op">(</span><span class="va">brain</span>, group.by <span class="op">=</span> <span class="st">"seurat_clusters"</span><span class="op">)</span></span></code></pre></div>
<p><img src="package-compatibility_files/figure-html/unnamed-chunk-2-1.png" width="50%"><img src="package-compatibility_files/figure-html/unnamed-chunk-2-2.png" width="50%"></p>
<p>For proper conversion information about certain aspects are
required.</p>
</div>
<div class="section level2">
<h2 id="the-sample-name">2.1 The sample name<a class="anchor" aria-label="anchor" href="#the-sample-name"></a>
</h2>
<p>The <code>sample_name</code> argument uniquely identifies the object
and dataset within a group of multiple <code>SPATA2</code> objects.</p>
</div>
<div class="section level2">
<h2 id="the-spatial-method">2.2 The spatial method<a class="anchor" aria-label="anchor" href="#the-spatial-method"></a>
</h2>
<p>The <code>platform</code> argument specifies the platform used, which
is integral to several SPATA2 functions as it stores details about the
underlying spatial method of the data. For a comprehensive understanding
of what constitutes a platform or spatial method in SPATA2, refer to the
documentation with <code><a href="../reference/spatial_methods.html">?spatial_methods</a></code>. Although the default
setting is <code>platform = 'Undefined'</code>, it is recommended to
specify this argument with a valid input. This specification is
necessary because the platform used cannot always be accurately inferred
from a <code>Seurat</code> object alone.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/validActivationFunctions.html">validSpatialMethods</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "MERFISH"     "SlideSeqV1"  "Undefined"   "VisiumSmall" "VisiumLarge"</span></span>
<span><span class="co">## [6] "VisiumHD"    "Xenium"</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="assay-name-and-assay-modality">2.3 Assay name and assay modality<a class="anchor" aria-label="anchor" href="#assay-name-and-assay-modality"></a>
</h2>
<p>The <code>assay_name</code> argument indicates which assay from the
<code>Seurat</code> object should be used. In many cases, only one assay
is present, making the default setting of <code>assay_name = NULL</code>
sufficient. However, note that Seurat and SPATA2 handle assays slightly
differently. For example, using the <code><a href="https://satijalab.org/seurat/reference/SCTransform.html" class="external-link">SCTransform()</a></code> function
in Seurat creates a new assay within the <code>Seurat</code> object.
Despite these differences, both contain gene expression data.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">brain</span><span class="op">@</span><span class="va">assays</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Spatial" "SCT"</span></span></code></pre>
<p>In SPATA2, assays are strictly sorted by molecular modality and thus,
only one assay of molecular modality <em>gene</em> can exist. In this
scenario, one has to choose the assay to use for conversion. Related
matrices can always be added afterwards via
<code><a href="../reference/addProcessedMatrix.html">addProcessedMatrix()</a></code>. Once you picked the assay of
interest, define the molecular modality. Optionally, you use either of
<em>‘gene’</em>, <em>‘metabolite’</em> or <em>‘protein’</em>. Read more
on how SPATA2 deals with molecular variables <a href="articles/molecular-variables.html">here</a>.</p>
</div>
<div class="section level2">
<h2 id="image-name">2.4 Image name<a class="anchor" aria-label="anchor" href="#image-name"></a>
</h2>
<p>Seurat objects contain spatial data in slot <code>@images</code>,
which is a list that can contain multiple slots. Similarly to assays, if
this list contains more than one <code>SpatialImage</code> objects, the
one to use must be specified. Furthermore, for appropriate scaling to
image resolutions the scale factor to use might need to be specified.
This is usually the case for Visium experiments.</p>
</div>
<div class="section level2">
<h2 id="convert">2.5 Convert<a class="anchor" aria-label="anchor" href="#convert"></a>
</h2>
<p>Eventually we can convert the object with <code><a href="../reference/asSPATA2.html">asSPATA2()</a></code>.
Note, that we specify <code>assay_name</code> since the
<code>Seurat</code> object contains two assays. However, we must not
specify <code>img_name</code> since only one image (<em>anterior1</em>
is present).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># two assays </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">brain</span><span class="op">@</span><span class="va">assays</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Spatial" "SCT"</span></span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># one image</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">brain</span><span class="op">@</span><span class="va">images</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "anterior1"</span></span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># use assay Spatial</span></span>
<span><span class="va">spata_object1</span> <span class="op">&lt;-</span></span>
<span> <span class="fu"><a href="../reference/asSPATA2.html">asSPATA2</a></span><span class="op">(</span></span>
<span>   object <span class="op">=</span> <span class="va">brain</span>,</span>
<span>   sample_name <span class="op">=</span> <span class="st">"mouse_brain"</span>,</span>
<span>   platform <span class="op">=</span> <span class="st">"VisiumSmall"</span>,</span>
<span>   img_scale_fct <span class="op">=</span> <span class="st">"lowres"</span>,</span>
<span>   assay_name <span class="op">=</span> <span class="st">"Spatial"</span>, </span>
<span>   assay_modality <span class="op">=</span> <span class="st">"gene"</span></span>
<span>   <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/methods/show.html" class="external-link">show</a></span><span class="op">(</span><span class="va">spata_object1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## An object of class SPATA2</span></span>
<span><span class="co">## Sample: mouse_brain </span></span>
<span><span class="co">## Size: 2696 x 31053 (spots x molecules)</span></span>
<span><span class="co">## Memory: 445.4 Mb</span></span>
<span><span class="co">## Platform: VisiumSmall </span></span>
<span><span class="co">## Molecular assays (1):</span></span>
<span><span class="co">## 1. Assay</span></span>
<span><span class="co">##  Molecular modality: gene</span></span>
<span><span class="co">##  Distinct molecules: 31053</span></span>
<span><span class="co">##  Matrices (2):</span></span>
<span><span class="co">##  -counts (active)</span></span>
<span><span class="co">##  -data</span></span>
<span><span class="co">## Registered images (1):</span></span>
<span><span class="co">## - anterior1 (599x600 px, active, loaded)</span></span>
<span><span class="co">## Meta variables (10): sample, orig.ident, nCount_Spatial, nFeature_Spatial, slice, region, nCount_SCT, nFeature_SCT, SCT_snn_res.0.8, seurat_clusters</span></span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># use assay SCT</span></span>
<span><span class="va">spata_object2</span> <span class="op">&lt;-</span></span>
<span> <span class="fu"><a href="../reference/asSPATA2.html">asSPATA2</a></span><span class="op">(</span></span>
<span>   object <span class="op">=</span> <span class="va">brain</span>,</span>
<span>   sample_name <span class="op">=</span> <span class="st">"mouse_brain"</span>,</span>
<span>   platform <span class="op">=</span> <span class="st">"VisiumSmall"</span>,</span>
<span>   img_name <span class="op">=</span> <span class="st">"anterior1"</span>,</span>
<span>   img_scale_fct <span class="op">=</span> <span class="st">"lowres"</span>,</span>
<span>   assay_name <span class="op">=</span> <span class="st">"SCT"</span>,</span>
<span>   assay_modality <span class="op">=</span> <span class="st">"gene"</span></span>
<span>   <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/methods/show.html" class="external-link">show</a></span><span class="op">(</span><span class="va">spata_object2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## An object of class SPATA2</span></span>
<span><span class="co">## Sample: mouse_brain </span></span>
<span><span class="co">## Size: 2696 x 17668 (spots x molecules)</span></span>
<span><span class="co">## Memory: 523.08 Mb</span></span>
<span><span class="co">## Platform: VisiumSmall </span></span>
<span><span class="co">## Molecular assays (1):</span></span>
<span><span class="co">## 1. Assay</span></span>
<span><span class="co">##  Molecular modality: gene</span></span>
<span><span class="co">##  Distinct molecules: 17668</span></span>
<span><span class="co">##  Matrices (3):</span></span>
<span><span class="co">##  -counts (active)</span></span>
<span><span class="co">##  -data</span></span>
<span><span class="co">##  -scale.data</span></span>
<span><span class="co">## Registered images (1):</span></span>
<span><span class="co">## - anterior1 (599x600 px, active, loaded)</span></span>
<span><span class="co">## Meta variables (10): sample, orig.ident, nCount_Spatial, nFeature_Spatial, slice, region, nCount_SCT, nFeature_SCT, SCT_snn_res.0.8, seurat_clusters</span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># left plot</span></span>
<span><span class="fu"><a href="https://satijalab.org/seurat/reference/SpatialPlot.html" class="external-link">SpatialPlot</a></span><span class="op">(</span><span class="va">brain</span>, features <span class="op">=</span> <span class="st">"nCount_Spatial"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># right plot</span></span>
<span><span class="fu"><a href="../reference/plotSurface.html">plotSurface</a></span><span class="op">(</span><span class="va">spata_object1</span>, color_by <span class="op">=</span> <span class="st">"nCount_Spatial"</span>, pt_size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="package-compatibility_files/figure-html/unnamed-chunk-5-1.png" width="50%"><img src="package-compatibility_files/figure-html/unnamed-chunk-5-2.png" width="50%"></p>
</div>
<div class="section level2">
<h2 id="anndata">3. AnnData<a class="anchor" aria-label="anchor" href="#anndata"></a>
</h2>
<p>For demonstrating Scanpy/Squidpy compatibility, we provide a
preprocessed 10X Visium dataset from the mouse brain. It was exported as
<code>h5ad</code> file from Python using
<code>AnnData.write_h5ad()</code>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://anndata.dynverse.org" class="external-link">anndata</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://themilolab.com/" class="external-link">SPATA2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># required for anndata R package; path to python (with anndata installed)</span></span>
<span><span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/use_python.html" class="external-link">use_python</a></span><span class="op">(</span><span class="st">"/my/path/to/python3"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># adjust to your directry</span></span>
<span><span class="va">dir</span> <span class="op">=</span> <span class="st">"/Users/simonf/PhD/TEMP/"</span></span>
<span></span>
<span><span class="fu">curl</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/curl/man/curl_download.html" class="external-link">curl_download</a></span><span class="op">(</span></span>
<span>  url <span class="op">=</span> <span class="st">"https://www.dropbox.com/s/pfpqyg1ds1d52f3/stab_wound_injury_anndata.h5ad?raw=1"</span>,</span>
<span>  destfile <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">dir</span>,<span class="st">"mouse_brain_adata.h5ad"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><code>h5ad</code> files can be loaded into R by using the
<code><a href="https://anndata.dynverse.org/reference/read_h5ad.html" class="external-link">read_h5ad()</a></code> function from the <a href="https://anndata.dynverse.org" class="external-link">anndata R package</a>.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">adata_object</span> <span class="op">&lt;-</span> <span class="fu">anndata</span><span class="fu">::</span><span class="fu"><a href="https://anndata.dynverse.org/reference/read_h5ad.html" class="external-link">read_h5ad</a></span><span class="op">(</span>filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">dir</span>,<span class="st">"mouse_brain_adata.h5ad"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The object is converted to SPATA2 using <code><a href="../reference/asSPATA2.html">asSPATA2()</a></code>.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spata_object</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/asSPATA2.html">asSPATA2</a></span><span class="op">(</span><span class="va">adata_object</span>, sample_name <span class="op">=</span> <span class="st">"mousebrain"</span>, platform <span class="op">=</span> <span class="st">"VisiumSmall"</span>, modality <span class="op">=</span> <span class="st">"gene"</span><span class="op">)</span></span></code></pre></div>
<p>If no AnnData layers are named, <code>adata.X</code> will be imported
as normalized matrix. Custom AnnData layers can be added as either count
matrix (<code>count_mtr_name</code>), normalized matrix
(<code>normalized_mtr_name</code>), or scaled matrix
(<code>normalized_mtr_name</code>) in the SPATA2 object, for instance as
<code>asSPATA2(adata, count_mtr_name = "count_matrix")</code>. That’s it
- the SPATA2 object can be used for any downstream analyses, such as
spatial annotation or spatial trajectory screening.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Jan Kueckelhaus, Dieter-Henrik Heiland.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer>
</div>






  </body>
</html>

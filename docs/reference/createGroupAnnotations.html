<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Create spatial annotations from a group of data points — createGroupAnnotations • SPATA2</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Create spatial annotations from a group of data points — createGroupAnnotations"><meta property="og:description" content="Creates spatial annotations based on the spatial extent of a
group of data points (spots or cells). See details for more information."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SPATA2</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/installation.html">Installation</a>
</li>
<li>
  <a href="../articles/spata-data.html">SPATAData</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tutorials

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li class="dropdown-header">Initiating a SPATA2 object</li>
    <li>
      <a href="../articles/initiation-and-preprocessing-customized.html">Initiation &amp; Preprocessing with individual data</a>
    </li>
    <li>
      <a href="../articles/initiation-and-preprocessing-merfish.html">Initiation &amp; Preprocessing with MERFISH data</a>
    </li>
    <li>
      <a href="../articles/initiation-and-preprocessing-visium.html">Initiation &amp; Preprocessing with Visium data</a>
    </li>
    <li>
      <a href="../articles/initiation-and-preprocessing-visium-hd.html">Initiation &amp; Preprocessing with VisiumHD data</a>
    </li>
    <li class="dropdown-header">Basic Manipulation of a SPATA2 object</li>
    <li>
      <a href="../articles/adding-data.html">Adding Data to SPATA2 objects</a>
    </li>
    <li>
      <a href="../articles/package-compatibility.html">Platform Compatibility</a>
    </li>
    <li>
      <a href="../articles/molecular-variables.html">Molecular Variables</a>
    </li>
    <li>
      <a href="../articles/image-handling.html">Image Handling</a>
    </li>
    <li>
      <a href="../articles/spatial-segmentation.html">Spatial Segmentation</a>
    </li>
    <li class="dropdown-header">Implemented Algorithms &amp; Concepts</li>
    <li>
      <a href="../articles/cnv.html">Copy Number Variations</a>
    </li>
    <li>
      <a href="../articles/clustering.html">Clustering</a>
    </li>
    <li>
      <a href="../articles/dimensional-reduction.html">Dimensional Reduction</a>
    </li>
    <li>
      <a href="../articles/dea.html">Differential Expression</a>
    </li>
    <li>
      <a href="../articles/gsea.html">Gene Set Enrichment</a>
    </li>
    <li>
      <a href="../articles/spatial-measures.html">Spatial Measures</a>
    </li>
    <li class="dropdown-header">Spatial Gradient Screening</li>
    <li>
      <a href="../articles/creating-spatial-annotations.html">Creating Spatial Annotations</a>
    </li>
    <li>
      <a href="../articles/using-spatial-annotations.html">Using Spatial Annotations</a>
    </li>
    <li>
      <a href="../articles/spatial-annotation-screening.html">Spatial Annotation Screening</a>
    </li>
    <li>
      <a href="../articles/creating-spatial-trajectories.html">Creating Spatial Trajectories</a>
    </li>
    <li>
      <a href="../articles/spatial-trajectory-screening.html">Spatial Trajectory Screening</a>
    </li>
    <li class="dropdown-header">Visualization</li>
    <li>
      <a href="../articles/plotting-surface.html">Surface Plotting</a>
    </li>
  </ul></li>
<li>
  <a href="../articles/newslog.html">Newslog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create spatial annotations from a group of data points</h1>

    <div class="hidden name"><code>createGroupAnnotations.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Creates spatial annotations based on the spatial extent of a
group of data points (spots or cells). See details for more information.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">createGroupAnnotations</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">grouping</span>,</span>
<span>  <span class="va">group</span>,</span>
<span>  <span class="va">id</span>,</span>
<span>  tags <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  tags_expand <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  use_dbscan <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  inner_borders <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  eps <span class="op">=</span> <span class="fu"><a href="recSgsRes.html">recDbscanEps</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span>,</span>
<span>  minPts <span class="op">=</span> <span class="fu"><a href="recSgsRes.html">recDbscanMinPts</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span>,</span>
<span>  min_size <span class="op">=</span> <span class="fu"><a href="nObs.html">nObs</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">*</span> <span class="fl">0.01</span>,</span>
<span>  force1 <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  concavity <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>An object of class <code><a href="SPATA2.html">SPATA2</a></code> or, in case of S4 generics,
objects of classes for which a method has been defined.</p></dd>


<dt id="arg-grouping">grouping<a class="anchor" aria-label="anchor" href="#arg-grouping"></a></dt>
<dd><p>Character value. The grouping variable containing the group
of interest.</p></dd>


<dt id="arg-group">group<a class="anchor" aria-label="anchor" href="#arg-group"></a></dt>
<dd><p>Character value. The group of interest.</p></dd>


<dt id="arg-id">id<a class="anchor" aria-label="anchor" href="#arg-id"></a></dt>
<dd><p>Character value. The ID of the spatial annotation. If <code>NULL</code>,
the ID of the annotation is created by combining the string <em>'spat_ann'</em> with
the index the new annotation has in the list of all annotations.</p></dd>


<dt id="arg-tags">tags<a class="anchor" aria-label="anchor" href="#arg-tags"></a></dt>
<dd><p>A character vector of tags for the spatial annotation.</p></dd>


<dt id="arg-tags-expand">tags_expand<a class="anchor" aria-label="anchor" href="#arg-tags-expand"></a></dt>
<dd><p>Logical value. If <code>TRUE</code>, the tags with which the image
annotations are tagged are expanded by the unsuffixed <code>id</code>, the <code>grouping</code>,
the <code>group</code> and <em>'createGroupAnnotations'</em>.</p></dd>


<dt id="arg-use-dbscan">use_dbscan<a class="anchor" aria-label="anchor" href="#arg-use-dbscan"></a></dt>
<dd><p>Logical value. If <code>TRUE</code>, the DBSCAN algorithm is used to identify
spatial clusters and outliers before the outline of the spatial annotation is drawn.</p></dd>


<dt id="arg-inner-borders">inner_borders<a class="anchor" aria-label="anchor" href="#arg-inner-borders"></a></dt>
<dd><p>Logical value. If <code>TRUE</code>, the algorithm checks whether the
annotation requires inner borders and sets them accordingly. If <code>FALSE</code>, only
an outer border is created.</p></dd>


<dt id="arg-eps">eps<a class="anchor" aria-label="anchor" href="#arg-eps"></a></dt>
<dd><p>Distance measure. Given to <code>eps</code> of <code><a href="https://rdrr.io/pkg/dbscan/man/dbscan.html" class="external-link">dbscan::dbscan()</a></code>. Determines
the size (radius) of the epsilon neighborhood.</p></dd>


<dt id="arg-minpts">minPts<a class="anchor" aria-label="anchor" href="#arg-minpts"></a></dt>
<dd><p>Numeric value. Given to <code><a href="https://rdrr.io/pkg/dbscan/man/dbscan.html" class="external-link">dbscan::dbscan()</a></code>. Determines the
number of minimum points required in the eps neighborhood for core points
(including the point itself)</p></dd>


<dt id="arg-min-size">min_size<a class="anchor" aria-label="anchor" href="#arg-min-size"></a></dt>
<dd><p>Numeric value. The minimum number of data points a dbscan cluster
must have in order not to be discarded as a spatial outlier.</p></dd>


<dt id="arg-force-">force1<a class="anchor" aria-label="anchor" href="#arg-force-"></a></dt>
<dd><p>Logical value. If <code>TRUE</code>, spatial sub groups identified by DBSCAN
are merged into one cluster. <strong>Note</strong>: If <code>FALSE</code> (the default), the input for <code>ìd</code> is suffixed
with an index to label each spatial annotation created uniquely, regardless of
how many are eventually created. E.g. if <code>id = "my_ann"</code> and the algorithm
created two spatial annotations, they are named <em>my_ann_1</em> and <em>my_ann_2</em>.</p></dd>


<dt id="arg-concavity">concavity<a class="anchor" aria-label="anchor" href="#arg-concavity"></a></dt>
<dd><p>Numeric value. Given to argument <code>concavity</code> of
<code><a href="https://joelgombin.github.io/concaveman/reference/concaveman.html" class="external-link">concaveman::concaveman()</a></code>. Determines the relative measure of concavity.
1 results in a relatively detailed shape, Infinity results in a convex hull.
You can use values lower than 1, but they can produce pretty crazy shapes.</p></dd>


<dt id="arg-overwrite">overwrite<a class="anchor" aria-label="anchor" href="#arg-overwrite"></a></dt>
<dd><p>Logical value. Must be <code>TRUE</code> to allow overwriting.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, informative messages regarding
the computational progress will be printed.</p>
<p>(Warning messages will always be printed.)</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>The updated input object, containing the added, removed or computed results.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The functions filters the coordinates data.frame obtained via <code><a href="getCoordsDf.html">getCoordsDf()</a></code>
based on the input of argument <code>grouping</code> and <code>group</code>.</p>
<p>Following filtering, if <code>use_dbscan</code> is <code>TRUE</code>, the DBSCAN algorithm
identifies spatial outliers, which are then removed. Furthermore, if DBSCAN
detects multiple dense clusters, they can be merged into a single group
if <code>force1</code> is also set to <code>TRUE</code>.</p>
<p>It is essential to note that bypassing the DBSCAN step may lead to the inclusion
of individual data points dispersed across the sample. This results in an image
annotation that essentially spans the entirety of the sample, lacking the
segregation of specific variable expressions. Similarly, enabling <code>force1</code>
might unify multiple segregated areas, present on both sides of the sample, into one
group and subsequently, one image annotation encompassing the whole sample.
Consider to allow the creation of multiple spatial annotations (suffixed with an index)
and merging them afterwards via <code><a href="mergeSpatialAnnotations.html">mergeSpatialAnnotations()</a></code> if they are too
close together.</p>
<p>Lastly, the remaining data points are fed into the concaveman algorithm on a
per-group basis. The algorithm calculates concave polygons outlining the groups
of data points. If <code>dbscan_use</code> is <code>FALSE</code>, all data points that remained after the
initial filtering are submitted to the algorithm. Subsequently, these polygons are
integrated into <code><a href="addSpatialAnnotation.html">addSpatialAnnotation()</a></code> along with the unsuffixed <code>id</code> and
<code>tags</code> input arguments. The ID is suffixed with an index for each group.</p>
    </div>
    <div id="distance-measures">
    <h2>Distance measures</h2>



<p>The vignette on distance measures in SPATA2 has been replaced. Click
<code><a href="concept_distance_measure.html">here</a></code> to read it.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="recSgsRes.html">recDbscanEps()</a></code>, <code><a href="recSgsRes.html">recDbscanMinPts()</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://themilolab.com/" class="external-link">SPATA2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"example_data"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">object</span> <span class="op">&lt;-</span> <span class="va">example_data</span><span class="op">$</span><span class="va">object_UKF275T_diet</span></span>
<span></span>
<span><span class="va">object</span> <span class="op">&lt;-</span></span>
<span> <span class="fu">createGroupAnnotations</span><span class="op">(</span></span>
<span>   object <span class="op">=</span> <span class="va">object</span>,</span>
<span>   grouping <span class="op">=</span> <span class="st">"bayes_space"</span>,</span>
<span>   group <span class="op">=</span> <span class="st">"1"</span>,</span>
<span>   id <span class="op">=</span> <span class="st">"bspace1"</span>,</span>
<span>   tags <span class="op">=</span> <span class="st">"bspace_ann"</span></span>
<span>   <span class="op">)</span></span>
<span></span>
<span> <span class="fu"><a href="plotSurface.html">plotSurface</a></span><span class="op">(</span><span class="va">object</span>, color_by <span class="op">=</span> <span class="st">"bayes_space"</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="ggpLayerSpatAnnOutline.html">ggpLayerSpatAnnOutline</a></span><span class="op">(</span><span class="va">object</span>, tags <span class="op">=</span> <span class="st">"bspace_ann"</span><span class="op">)</span></span>
<span></span></code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Jan Kueckelhaus, Dieter-Henrik Heiland.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>


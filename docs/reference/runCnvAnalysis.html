<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Identify large-scale chromosomal copy number variations — runCnvAnalysis • SPATA2</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Identify large-scale chromosomal copy number variations — runCnvAnalysis"><meta property="og:description" content="This functions integrates large-scale copy number variations analysis
using the inferncnv-package. For more detailed information about infercnv works
visit https://github.com/broadinstitute/inferCNV/wiki."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SPATA2</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/spata-v2-installation.html">Installation</a>
</li>
<li>
  <a href="../articles/spata-v2-spata-data.html">SPATAData</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li class="dropdown-header">Around the spata2 object</li>
    <li>
      <a href="../articles/spata-v2-object-initiation-and-manipulation.html">Object Set Up and Manipulation</a>
    </li>
    <li>
      <a href="../articles/spata-v2-platform-compatibility.html">Platform Compatibility</a>
    </li>
    <li>
      <a href="../articles/spata-v2-autoencoder.html">Autoencoder</a>
    </li>
    <li>
      <a href="../articles/spata-v2-genes-gene-sets-and-features.html">Genes, Gene Sets and Features</a>
    </li>
    <li class="dropdown-header">Image Analysis</li>
    <li>
      <a href="../articles/spata-v2-image-handling.html">Image Handling</a>
    </li>
    <li>
      <a href="../articles/spata-v2-image-annotations.html">Image Annotations</a>
    </li>
    <li>
      <a href="../articles/spata-v2-spatial-segmentation.html">Spatial Segmentation</a>
    </li>
    <li class="dropdown-header">Analysis of Gene Expression</li>
    <li>
      <a href="../articles/spata-v2-cnv-analysis.html">Copy Number Variations</a>
    </li>
    <li>
      <a href="../articles/spata-v2-clustering.html">Clustering</a>
    </li>
    <li>
      <a href="../articles/spata-v2-dea.html">Differential Expression</a>
    </li>
    <li>
      <a href="../articles/spata-v2-gsea.html">Gene Set Enrichment</a>
    </li>
    <li class="dropdown-header">Expression Gradients &amp; Gradient Screening</li>
    <li>
      <a href="../articles/spata-v2-spatial-trajectories.html">Spatial Trajectories</a>
    </li>
    <li>
      <a href="../articles/spata-v2-spatial-trajectory-screening.html">Spatial Trajectory Screening</a>
    </li>
    <li>
      <a href="../articles/spata-v2-image-annotation-screening.html">Image Annotation Screening</a>
    </li>
    <li>
      <a href="../articles/spata-v2-scd.html">Integrate Single Cell Deconvolution</a>
    </li>
    <li class="dropdown-header">Visualization</li>
    <li>
      <a href="../articles/spata-v2-plotting-surface.html">Surface Plotting</a>
    </li>
    <li>
      <a href="../articles/spata-v2-plotting-misc.html">Miscellaneous</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Code &amp; Concept
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/cc-spatial-measures.html">Spatial Measures</a>
    </li>
    <li>
      <a href="../articles/cc-spatial-segmentation-vs-image-annotations.html">Spatial Segmentation vs. Image Annotations</a>
    </li>
    <li>
      <a href="../articles/cc-spatial-trajectory-screening.html">Spatial Trajectory Screening</a>
    </li>
    <li>
      <a href="../articles/cc-image-annotation-screening.html">Image Annotation Screening</a>
    </li>
    <li>
      <a href="../articles/cc-model-fitting-in-spatial-transcriptomic-studies.html">Model Fitting</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Identify large-scale chromosomal copy number variations</h1>
    
    <div class="hidden name"><code>runCnvAnalysis.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This functions integrates large-scale copy number variations analysis
using the inferncnv-package. For more detailed information about infercnv works
visit <em>https://github.com/broadinstitute/inferCNV/wiki</em>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">runCnvAnalysis</span><span class="op">(</span>
  <span class="va">object</span>,
  ref_annotation <span class="op">=</span> <span class="va">cnv_ref</span><span class="op">[[</span><span class="st">"annotation"</span><span class="op">]</span><span class="op">]</span>,
  ref_mtr <span class="op">=</span> <span class="va">cnv_ref</span><span class="op">[[</span><span class="st">"mtr"</span><span class="op">]</span><span class="op">]</span>,
  ref_regions <span class="op">=</span> <span class="va">cnv_ref</span><span class="op">[[</span><span class="st">"regions"</span><span class="op">]</span><span class="op">]</span>,
  gene_pos_df <span class="op">=</span> <span class="fu">SPATA2</span><span class="fu">::</span><span class="va"><a href="gene_pos_df.html">gene_pos_df</a></span>,
  directory_cnv_folder <span class="op">=</span> <span class="st">"data-development/cnv-results"</span>,
  directory_regions_df <span class="op">=</span> <span class="cn">NA</span>,
  n_pcs <span class="op">=</span> <span class="fl">30</span>,
  cnv_prefix <span class="op">=</span> <span class="st">"Chr"</span>,
  save_infercnv_object <span class="op">=</span> <span class="cn">TRUE</span>,
  verbose <span class="op">=</span> <span class="cn">NULL</span>,
  of_sample <span class="op">=</span> <span class="cn">NA</span>,
  CreateInfercnvObject <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ref_group_names <span class="op">=</span> <span class="st">"ref"</span><span class="op">)</span>,
  require_above_min_mean_expr_cutoff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>min_mean_expr_cutoff <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>,
  require_above_min_cells_ref <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>min_cells_per_gene <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,
  normalize_counts_by_seq_depth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,
  anscombe_transform <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,
  log2xplus1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,
  apply_max_threshold_bounds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,
  smooth_by_chromosome <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>window_length <span class="op">=</span> <span class="fl">101</span>, smooth_ends <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
  center_cell_expr_across_chromosome <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"median"</span><span class="op">)</span>,
  subtract_ref_expr_from_obs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>inv_log <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
  invert_log2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,
  clear_noise_via_ref_mean_sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sd_amplifier <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span>,
  remove_outliers_norm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,
  define_signif_tumor_subclusters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>p_val <span class="op">=</span> <span class="fl">0.05</span>, hclust_method <span class="op">=</span> <span class="st">"ward.D2"</span>,
    cluster_by_groups <span class="op">=</span> <span class="cn">TRUE</span>, partition_method <span class="op">=</span> <span class="st">"qnorm"</span><span class="op">)</span>,
  plot_cnv <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>k_obs_groups <span class="op">=</span> <span class="fl">5</span>, cluster_by_groups <span class="op">=</span> <span class="cn">TRUE</span>, output_filename <span class="op">=</span>
    <span class="st">"infercnv.outliers_removed"</span>, color_safe_pal <span class="op">=</span> <span class="cn">FALSE</span>, x.range <span class="op">=</span> <span class="st">"auto"</span>, x.center <span class="op">=</span> <span class="fl">1</span>,
    output_format <span class="op">=</span> <span class="st">"pdf"</span>, title <span class="op">=</span> <span class="st">"Outliers Removed"</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>object</dt>
<dd><p>An object of class <code>spata2</code>.</p></dd>


<dt>ref_annotation</dt>
<dd><p>A data.frame in which the row names refer to the barcodes of
the reference matrix provided in argument <code>ref_mtr</code> and
and a column named <em>sample</em> that refers to the reference group names.</p>
<p>Defaults to the data.frame stored in slot <code>$annotation</code> of list <code><a href="cnv_ref.html">SPATA2::cnv_ref</a></code>.</p>
<p>If you provide your own reference, make sure that barcodes of the reference
input do not overlap with barcodes of the spata-object. (e.g. by suffixing as
exemplified in the default list <code><a href="cnv_ref.html">SPATA2::cnv_ref</a></code>.)</p></dd>


<dt>ref_mtr</dt>
<dd><p>The count matrix that is supposed to be used as the reference.
Row names must refer to the gene names and column names must refer to
the barcodes. Barcodes must be identical to the row names of the data.frame
provided in argument <code>ref_annotation.</code></p>
<p>Defaults to the count matrix stored in slot <code>$mtr</code> of list <code><a href="cnv_ref.html">SPATA2::cnv_ref</a></code>.</p>
<p>If you provide your own reference, make sure that barcodes of the reference
input do not overlap with barcodes of the spata-object. (e.g. by suffixing as
exemplified in the default list <code><a href="cnv_ref.html">SPATA2::cnv_ref</a></code>.)</p></dd>


<dt>ref_regions</dt>
<dd><p>A data.frame that contains information about chromosome positions.</p>
<p>Defaults to the data.frame stored in slot <code>$regions</code> of list <code><a href="cnv_ref.html">SPATA2::cnv_ref</a></code>.</p>
<p>If you provide your own regions reference, make sure that the data.frame has equal column names
and row names as the default input.</p></dd>


<dt>gene_pos_df</dt>
<dd><p>Either NULL or a data.frame. If data.frame, it replaces
the output of <code>CONICsmat::getGenePositions()</code>. Must contain three
character variables <em>ensembl_gene_id</em>, <em>hgnc_symbol</em>, <em>chromosome_name</em>
and two numeric variables <em>start_position</em> and <em>end_position.</em>.</p>
<p>If NULL the data.frame is created via <code>CONICsmat::getGenePositions()</code> using
all gene names that appear in the count matrix and in the reference matrix.</p>
<p>Defaults to the SPATA2 intern data.frame <code><a href="gene_pos_df.html">SPATA2::gene_pos_df</a></code>.</p></dd>


<dt>directory_cnv_folder</dt>
<dd><p>Character value. A directory that leads to the folder
in which to store temporary files, the infercnv-object as well as the output
heatmap.</p></dd>


<dt>cnv_prefix</dt>
<dd><p>Character value. Denotes the string with which the
the feature variables in which the information about the chromosomal gains and
losses are stored are prefixed.</p></dd>


<dt>save_infercnv_object</dt>
<dd><p>Logical value. If set to TRUE the infercnv-object
is stored in the folder denoted in argument <code>directory_cnv_folder</code> under
<em>'infercnv-object.RDS</em>.</p></dd>


<dt>verbose</dt>
<dd><p>Logical. If set to TRUE informative messages regarding
the computational progress will be printed.</p>
<p>(Warning messages will always be printed.)</p></dd>


<dt>of_sample</dt>
<dd><p>This argument is currently inactive. It might be reactivated when
spata-objects can store more than one sample.</p></dd>


<dt>CreateInfercnvObject</dt>
<dd><p>A list of arguments with which the function is supposed
to be called. Make sure that your input does not conflict with downstream function
calls. Input for argument <code>infercnv_obj</code> must not be specified.</p></dd>


<dt>require_above_min_mean_expr_cutoff</dt>
<dd><p>A list of arguments with which the function is supposed
to be called. Make sure that your input does not conflict with downstream function
calls. Input for argument <code>infercnv_obj</code> must not be specified.</p></dd>


<dt>require_above_min_cells_ref</dt>
<dd><p>A list of arguments with which the function is supposed
to be called. Make sure that your input does not conflict with downstream function
calls. Input for argument <code>infercnv_obj</code> must not be specified.</p></dd>


<dt>normalize_counts_by_seq_depth</dt>
<dd><p>A list of arguments with which the function is supposed
to be called. Make sure that your input does not conflict with downstream function
calls. Input for argument <code>infercnv_obj</code> must not be specified.</p></dd>


<dt>anscombe_transform</dt>
<dd><p>A list of arguments with which the function is supposed
to be called. Make sure that your input does not conflict with downstream function
calls. Input for argument <code>infercnv_obj</code> must not be specified.</p></dd>


<dt>log2xplus1</dt>
<dd><p>A list of arguments with which the function is supposed
to be called. Make sure that your input does not conflict with downstream function
calls. Input for argument <code>infercnv_obj</code> must not be specified.</p></dd>


<dt>apply_max_threshold_bounds</dt>
<dd><p>A list of arguments with which the function is supposed
to be called. Make sure that your input does not conflict with downstream function
calls. Input for argument <code>infercnv_obj</code> must not be specified.</p></dd>


<dt>smooth_by_chromosome</dt>
<dd><p>A list of arguments with which the function is supposed
to be called. Make sure that your input does not conflict with downstream function
calls. Input for argument <code>infercnv_obj</code> must not be specified.</p></dd>


<dt>center_cell_expr_across_chromosome</dt>
<dd><p>A list of arguments with which the function is supposed
to be called. Make sure that your input does not conflict with downstream function
calls. Input for argument <code>infercnv_obj</code> must not be specified.</p></dd>


<dt>subtract_ref_expr_from_obs</dt>
<dd><p>A list of arguments with which the function is supposed
to be called. Make sure that your input does not conflict with downstream function
calls. Input for argument <code>infercnv_obj</code> must not be specified.</p></dd>


<dt>invert_log2</dt>
<dd><p>A list of arguments with which the function is supposed
to be called. Make sure that your input does not conflict with downstream function
calls. Input for argument <code>infercnv_obj</code> must not be specified.</p></dd>


<dt>clear_noise_via_ref_mean_sd</dt>
<dd><p>A list of arguments with which the function is supposed
to be called. Make sure that your input does not conflict with downstream function
calls. Input for argument <code>infercnv_obj</code> must not be specified.</p></dd>


<dt>remove_outliers_norm</dt>
<dd><p>A list of arguments with which the function is supposed
to be called. Make sure that your input does not conflict with downstream function
calls. Input for argument <code>infercnv_obj</code> must not be specified.</p></dd>


<dt>define_signif_tumor_subclusters</dt>
<dd><p>A list of arguments with which the function is supposed
to be called. Make sure that your input does not conflict with downstream function
calls. Input for argument <code>infercnv_obj</code> must not be specified.</p></dd>


<dt>plot_cnv</dt>
<dd><p>A list of arguments with which the function is supposed
to be called. Make sure that your input does not conflict with downstream function
calls. Input for argument <code>infercnv_obj</code> and  must not be specified. Input for argument
<code>out_dir</code> is taken from argument <code>directory_cnv_folder</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>An updated spata-object containg the results in the respective slot.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p><code>runCnvAnalysis()</code> is a wrapper around all functions the infercnv-pipeline
is composed of. Argument <code>directory_cnv_folder</code> should lead to an empty folder as
temporary files as well as the output heatmap and the infercnv-object are stored
there without asking for permission which can lead to overwriting due to naming issues.</p>
<p>Results (including a PCA) are stored in the slot @cnv of the spata-object
which can be obtained via <code><a href="getCnvResults.html">getCnvResults()</a></code>. Additionally, the variables
that store the copy-number-variations for each barcode-spot are added to
the spata-object's feature data. The corresponding feature variables are named according
to the chromosome's number and the prefix denoted with the argument <code>cnv_prefix.</code></p>
<p>Regarding the reference data:
In the list <code><a href="cnv_ref.html">SPATA2::cnv_ref</a></code> we offer reference data including a count matrix
that results from stRNA-seq of healthy human brain tissue, an annotation data.frame as
well as a data.frame containing information regarding the chromosome positions.
You can choose to provide your own reference data by specifying the <code>ref_*</code>-arguments.
Check out the content of list <code><a href="cnv_ref.html">SPATA2::cnv_ref</a></code> and make sure that your own
reference input is of similiar structure regarding column names, rownames, etc.</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Jan Kueckelhaus, Dieter-Henrik Heiland, Simon Frerich.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>


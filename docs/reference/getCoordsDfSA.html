<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Relate points to spatial annotations — getCoordsDfSA • SPATA2</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Relate points to spatial annotations — getCoordsDfSA"><meta property="og:description" content="Adds the spatial relation to a spatial
annotation to the coordinates data.frame. See details and examples for more."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SPATA2</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/installation.html">Installation</a>
</li>
<li>
  <a href="../articles/spata-data.html">SPATAData</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tutorials

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li class="dropdown-header">Initiating a SPATA2 object</li>
    <li>
      <a href="../articles/initiation-and-preprocessing-customized.html">Initiation &amp; Preprocessing with individual data</a>
    </li>
    <li>
      <a href="../articles/initiation-and-preprocessing-merfish.html">Initiation &amp; Preprocessing with MERFISH data</a>
    </li>
    <li>
      <a href="../articles/initiation-and-preprocessing-visium.html">Initiation &amp; Preprocessing with Visium data</a>
    </li>
    <li>
      <a href="../articles/initiation-and-preprocessing-visium-hd.html">Initiation &amp; Preprocessing with VisiumHD data</a>
    </li>
    <li class="dropdown-header">Basic Manipulation of a SPATA2 object</li>
    <li>
      <a href="../articles/adding-data.html">Adding Data to SPATA2 objects</a>
    </li>
    <li>
      <a href="../articles/package-compatibility.html">Platform Compatibility</a>
    </li>
    <li>
      <a href="../articles/molecular-variables.html">Molecular Variables</a>
    </li>
    <li>
      <a href="../articles/image-handling.html">Image Handling</a>
    </li>
    <li>
      <a href="../articles/spatial-segmentation.html">Spatial Segmentation</a>
    </li>
    <li class="dropdown-header">Implemented Algorithms &amp; Concepts</li>
    <li>
      <a href="../articles/cnv.html">Copy Number Variations</a>
    </li>
    <li>
      <a href="../articles/clustering.html">Clustering</a>
    </li>
    <li>
      <a href="../articles/dimensional-reduction.html">Dimensional Reduction</a>
    </li>
    <li>
      <a href="../articles/dea.html">Differential Expression</a>
    </li>
    <li>
      <a href="../articles/gsea.html">Gene Set Enrichment</a>
    </li>
    <li>
      <a href="../articles/spatial-measures.html">Spatial Measures</a>
    </li>
    <li class="dropdown-header">Spatial Gradient Screening</li>
    <li>
      <a href="../articles/creating-spatial-annotations.html">Creating Spatial Annotations</a>
    </li>
    <li>
      <a href="../articles/using-spatial-annotations.html">Using Spatial Annotations</a>
    </li>
    <li>
      <a href="../articles/spatial-annotation-screening.html">Spatial Annotation Screening</a>
    </li>
    <li>
      <a href="../articles/creating-spatial-trajectories.html">Creating Spatial Trajectories</a>
    </li>
    <li>
      <a href="../articles/spatial-trajectory-screening.html">Spatial Trajectory Screening</a>
    </li>
    <li class="dropdown-header">Visualization</li>
    <li>
      <a href="../articles/plotting-surface.html">Surface Plotting</a>
    </li>
  </ul></li>
<li>
  <a href="../articles/newslog.html">Newslog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Relate points to spatial annotations</h1>

    <div class="hidden name"><code>getCoordsDfSA.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Adds the spatial relation to a spatial
annotation to the coordinates data.frame. See details and examples for more.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">getCoordsDfSA</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  ids <span class="op">=</span> <span class="fu"><a href="idSA.html">idSA</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span>,</span>
<span>  distance <span class="op">=</span> <span class="st">"dte"</span>,</span>
<span>  resolution <span class="op">=</span> <span class="fu"><a href="recSgsRes.html">recSgsRes</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span>,</span>
<span>  core <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  core0 <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  periphery <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  angle_span <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">360</span><span class="op">)</span>,</span>
<span>  n_bins_angle <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  dist_unit <span class="op">=</span> <span class="fu"><a href="getDefaultUnit.html">getDefaultUnit</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span>,</span>
<span>  coords_df <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  variables <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  format <span class="op">=</span> <span class="st">"wide"</span>,</span>
<span>  incl_edge <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  drop_na <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">getCoordsDfST</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  id <span class="op">=</span> <span class="fu"><a href="idSA.html">idST</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span>,</span>
<span>  width <span class="op">=</span> <span class="fu"><a href="getTrajectoryLength.html">getTrajectoryLength</a></span><span class="op">(</span><span class="va">object</span>, id <span class="op">=</span> <span class="va">id</span><span class="op">)</span>,</span>
<span>  dist_unit <span class="op">=</span> <span class="fu"><a href="getDefaultUnit.html">getDefaultUnit</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span>,</span>
<span>  resolution <span class="op">=</span> <span class="fu"><a href="recSgsRes.html">recSgsRes</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span>,</span>
<span>  outside <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  variables <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  format <span class="op">=</span> <span class="st">"wide"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>An object of class <code><a href="SPATA2.html">SPATA2</a></code> or, in case of S4 generics,
objects of classes for which a method has been defined.</p></dd>


<dt id="arg-ids">ids<a class="anchor" aria-label="anchor" href="#arg-ids"></a></dt>
<dd><p>Character vector. Specifies the IDs of the spatial annotations of interest.</p></dd>


<dt id="arg-distance">distance<a class="anchor" aria-label="anchor" href="#arg-distance"></a></dt>
<dd><p><code><a href="concept_distance_measure.html">Distance measure</a></code>. Specifies
the distance from the border of the spatial annotation to the <em>horizon</em> in
the periphery up to which the screening is conducted. Defaults to a distance
that covers the whole tissue section the spatial annotation is located
on using <code><a href="distToEdge.html">distToEdge()</a></code>. (This distance must not be exceeded.)</p></dd>


<dt id="arg-resolution">resolution<a class="anchor" aria-label="anchor" href="#arg-resolution"></a></dt>
<dd><p><a href="concept_distance_measure.html">Distance measure</a>. The resolution
with which the expression gradient is inferred. Defaults are platform specific.
See more in detail section of <code><a href="recSgsRes.html">recSgsRes()</a></code>.</p></dd>


<dt id="arg-core">core<a class="anchor" aria-label="anchor" href="#arg-core"></a></dt>
<dd><p>Logical value. If <code>FALSE</code>, data points that lie inside the core of the
spatial annotation are removed.</p></dd>


<dt id="arg-core-">core0<a class="anchor" aria-label="anchor" href="#arg-core-"></a></dt>
<dd><p>Logical value. If <code>TRUE</code>, <em>dist</em> valus of core data points are
set to 0.</p></dd>


<dt id="arg-angle-span">angle_span<a class="anchor" aria-label="anchor" href="#arg-angle-span"></a></dt>
<dd><p>Numeric vector of length 2. Confines the area screened by
an angle span relative to the center of its closest spatial annotation.</p></dd>


<dt id="arg-n-bins-angle">n_bins_angle<a class="anchor" aria-label="anchor" href="#arg-n-bins-angle"></a></dt>
<dd><p>Numeric value. The number of bins in which observations
are categorized in the variable <em>bins_angle</em>.</p></dd>


<dt id="arg-dist-unit">dist_unit<a class="anchor" aria-label="anchor" href="#arg-dist-unit"></a></dt>
<dd><p>Character value. Unit in which the distance is computed.
Defaults to <em>pixel</em>.</p></dd>


<dt id="arg-coords-df">coords_df<a class="anchor" aria-label="anchor" href="#arg-coords-df"></a></dt>
<dd><p>Data.frame. If <code>NULL</code>, the default, the coordinates data.frame obtained
via <code><a href="getCoordsDf.html">getCoordsDf()</a></code> is used. Else other data.frame of observations can be put in
relation to the spatial annotation. Requires numeric variables named <em>x</em> and <em>y</em> in
pixel units.</p></dd>


<dt id="arg-variables">variables<a class="anchor" aria-label="anchor" href="#arg-variables"></a></dt>
<dd><p>Character vector. The numeric variables to be included in
the screening process. Makre sure that the correct matrix is active in the
respective assays.</p></dd>


<dt id="arg-format">format<a class="anchor" aria-label="anchor" href="#arg-format"></a></dt>
<dd><p>Character value. Either <em>'long'</em> or <em>'wide'</em>. Defaults to
<em>'wide'</em>. If <em>'wide'</em> each variable gets a column.  If <em>'long'</em>, the data.frame
is organized such that a column called <em>variables</em> contains the variable names
and a column called <em>'values'</em> contains the values.</p></dd>


<dt id="arg-incl-edge">incl_edge<a class="anchor" aria-label="anchor" href="#arg-incl-edge"></a></dt>
<dd><p>Logical value. If <code>TRUE</code>, the default, the edges of the
tissue sections identified by <code><a href="identifyTissueOutline.html">identifyTissueOutline()</a></code> are used to ensure
that the only data points are related to the spatial annotation that are located on
the same tissue section as the spatial annotation. Data points that do not share
the same tissue section obtain NAs for the created variables.</p></dd>


<dt id="arg-drop-na">drop_na<a class="anchor" aria-label="anchor" href="#arg-drop-na"></a></dt>
<dd><p>Logical value (only relevant if <code>incl_edge = TRUE</code>). If <code>TRUE</code>,
the default, data points that do not share the same tissue section with the spatial
annotation are dropped!</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, informative messages regarding
the computational progress will be printed.</p>
<p>(Warning messages will always be printed.)</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments given to <code><a href="joinWithVariables.html">joinWithVariables()</a></code>. Only used
if not empty and <code>coords_df</code> is <code>NULL</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>Data.frame. See details for more.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The coordinates data.frame as returned by <code><a href="getCoordsDf.html">getCoordsDf()</a></code> with additional variables:</p>
<ul><li><p><em>dist</em>: Numeric. The distance of the data point to the outline of the spatial annotation.</p></li>
<li><p><em>dist_unit</em>: Character. The unit in which the distance is computed.</p></li>
<li><p><em>bins_dist</em>: Factor. The bin the data point was assigned to based on its <em>dist</em> value and the <code>resolution</code>
parameter. Binwidth is equal to the value of <code>resolution</code>.</p></li>
<li><p><em>angle</em>: Numeric. The angle of the data point to the center of the spatial annotation.</p></li>
<li><p><em>bins_angle</em>: Factor. The bin the data point was assigned to based on its <em>angle</em> value.</p></li>
<li><p><em>rel_loc</em>: Character. Possible values are <em>'core'</em>, if the data point lies inside the spatial annotation,
<em>'periphery'</em> if the data point lies outside of the boundaries of the spatial annotation but inside
the area denoted via <code>distance</code> and <em>outside</em>, if the data point lies beyond the screening area (it's
distance to the spatial annotation boundaries is bigger than the value denoted in <code>distance</code>).</p></li>
<li><p><em>id</em> Character. The ID of the spatial annotation the data points lies closest to. (only relevant
in case of <code>length(ids) &gt; 1</code>)</p></li>
<li><p><em>tissue_section</em> Character. The tissue section on which the spatial annotation of variable <em>id</em> is located.</p></li>
</ul></div>
    <div id="note">
    <h2>Note</h2>
    <p>In most scenarious, it does <strong>not</strong> make sense to relate data points from
tissue sections to a spatial annotation that is located on a different
tissue section. Hence, the default of this function (<code>incl_edge = TRUE</code>, <code>drop_na = TRUE</code>)
is set to simply remove these data points from the output. See examples.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://themilolab.com/" class="external-link">SPATA2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"example_data"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Example 1 - One spatial annotation on one tissue section</span></span>
<span><span class="va">object</span> <span class="op">&lt;-</span> <span class="fu"><a href="loadExampleObject.html">loadExampleObject</a></span><span class="op">(</span><span class="st">"UKF275T"</span>, process <span class="op">=</span> <span class="cn">TRUE</span>, meta <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">object</span> <span class="op">&lt;-</span></span>
<span> <span class="fu"><a href="createNumericAnnotations.html">createNumericAnnotations</a></span><span class="op">(</span></span>
<span>   object <span class="op">=</span> <span class="va">object</span>,</span>
<span>   variable <span class="op">=</span> <span class="st">"HM_HYPOXIA"</span>,</span>
<span>   threshold <span class="op">=</span> <span class="st">"kmeans_high"</span>,</span>
<span>   id <span class="op">=</span> <span class="st">"hypoxia_ann"</span>,</span>
<span>   inner_borders <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>   force1 <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>   <span class="op">)</span></span>
<span></span>
<span><span class="co"># default distance = "dte" -&gt; uses distToEdge()</span></span>
<span><span class="va">coords_df</span> <span class="op">&lt;-</span> <span class="fu">getCoordsDfSA</span><span class="op">(</span><span class="va">object</span>, ids <span class="op">=</span> <span class="st">"hypoxia_ann"</span>, binwidth <span class="op">=</span> <span class="st">"1mm"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="plotSurface.html">plotSurface</a></span><span class="op">(</span><span class="va">object</span>, <span class="st">"HM_HYPOXIA"</span>, pt_clrsp <span class="op">=</span> <span class="st">"inferno"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="ggpLayerSpatAnnOutline.html">ggpLayerSpatAnnOutline</a></span><span class="op">(</span><span class="va">object</span>, ids <span class="op">=</span> <span class="st">"hypoxia_ann"</span>, line_color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="plotSurface.html">plotSurface</a></span><span class="op">(</span><span class="va">coords_df</span>, <span class="st">"dist"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span></span>
<span></span>
<span><span class="fu"><a href="plotSurface.html">plotSurface</a></span><span class="op">(</span><span class="va">coords_df</span>, color_by <span class="op">=</span> <span class="st">"bins_dist"</span>, pt_clrp <span class="op">=</span> <span class="st">"inferno"</span><span class="op">)</span></span>
<span><span class="fu"><a href="plotSurface.html">plotSurface</a></span><span class="op">(</span><span class="va">coords_df</span>, color_by <span class="op">=</span> <span class="st">"rel_loc"</span>, pt_clrp <span class="op">=</span> <span class="st">"npg"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">coords_df_3mm</span> <span class="op">&lt;-</span> <span class="fu">getCoordsDfSA</span><span class="op">(</span><span class="va">object</span>, ids <span class="op">=</span> <span class="st">"hypoxia_ann"</span>, resolution <span class="op">=</span> <span class="st">"2mm"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="plotSurface.html">plotSurface</a></span><span class="op">(</span><span class="va">coords_df_3mm</span>, color_by <span class="op">=</span> <span class="st">"dist"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="plotSurface.html">plotSurface</a></span><span class="op">(</span><span class="va">coords_df_3mm</span>, color_by <span class="op">=</span> <span class="st">"rel_loc"</span>, pt_clrp <span class="op">=</span> <span class="st">"npg"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">## Example 2 - Multiple spatial annotations on one tissue section</span></span>
<span></span>
<span><span class="va">object</span> <span class="op">&lt;-</span> <span class="fu"><a href="loadExampleObject.html">loadExampleObject</a></span><span class="op">(</span><span class="st">"UKF313T"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">necr_ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="getSpatAnnIds.html">getSpatAnnIds</a></span><span class="op">(</span><span class="va">object</span>, tags <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"compr"</span>, <span class="st">"necrotic"</span><span class="op">)</span>, test <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="plotSpatialAnnotations.html">plotSpatialAnnotations</a></span><span class="op">(</span><span class="va">object</span>, ids <span class="op">=</span> <span class="va">necr_ids</span>, line_size <span class="op">=</span> <span class="fl">1</span>, fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># considered individually</span></span>
<span></span>
<span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span></span>
<span>.x <span class="op">=</span> <span class="va">necr_ids</span>,</span>
<span>.f <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span>  <span class="va">coords_df</span> <span class="op">&lt;-</span> <span class="fu">getCoordsDfSA</span><span class="op">(</span><span class="va">object</span>, ids <span class="op">=</span> <span class="va">id</span>, distance <span class="op">=</span> <span class="st">"dte"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">p1</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="plotSurface.html">plotSurface</a></span><span class="op">(</span><span class="va">coords_df</span>, color_by <span class="op">=</span> <span class="st">"dist"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="ggpLayerSpatAnnOutline.html">ggpLayerSpatAnnOutline</a></span><span class="op">(</span><span class="va">object</span>, ids <span class="op">=</span> <span class="va">id</span>, line_color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="va">id</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">p1</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/wrap_plots.html" class="external-link">wrap_plots</a></span><span class="op">(</span><span class="va">.</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># considered alltogether</span></span>
<span></span>
<span><span class="va">coords_df</span> <span class="op">&lt;-</span> <span class="fu">getCoordsDfSA</span><span class="op">(</span><span class="va">object</span>, ids <span class="op">=</span> <span class="va">necr_ids</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="plotSurface.html">plotSurface</a></span><span class="op">(</span><span class="va">coords_df</span>, color_by <span class="op">=</span> <span class="st">"dist"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="ggpLayerSpatAnnOutline.html">ggpLayerSpatAnnOutline</a></span><span class="op">(</span><span class="va">object</span>, ids <span class="op">=</span> <span class="va">necr_ids</span><span class="op">)</span></span>
<span></span>
<span><span class="va">coords_df</span> <span class="op">&lt;-</span> <span class="fu">getCoordsDfSA</span><span class="op">(</span><span class="va">object</span>, ids <span class="op">=</span> <span class="va">necr_ids</span>, core0 <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="plotSurface.html">plotSurface</a></span><span class="op">(</span><span class="va">coords_df</span>, color_by <span class="op">=</span> <span class="st">"dist"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="ggpLayerSpatAnnOutline.html">ggpLayerSpatAnnOutline</a></span><span class="op">(</span><span class="va">object</span>, ids <span class="op">=</span> <span class="va">necr_ids</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">## Example 3 - Multiple tissue sections</span></span>
<span></span>
<span><span class="va">object</span> <span class="op">&lt;-</span> <span class="fu"><a href="loadExampleObject.html">loadExampleObject</a></span><span class="op">(</span><span class="st">"LMU_MCI"</span>, process <span class="op">=</span> <span class="cn">TRUE</span>, meta <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="plotSurface.html">plotSurface</a></span><span class="op">(</span><span class="va">object</span>, color_by <span class="op">=</span> <span class="st">"tissue_section"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="ggpLayerTissueOutline.html">ggpLayerTissueOutline</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="plotSpatialAnnotations.html">plotSpatialAnnotations</a></span><span class="op">(</span><span class="va">object</span>, ids <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"inj1"</span>, <span class="st">"inj2"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># the default</span></span>
<span><span class="va">coords_df</span> <span class="op">&lt;-</span> <span class="fu">getCoordsDfSA</span><span class="op">(</span><span class="va">object</span>, ids <span class="op">=</span> <span class="st">"inj1"</span>, incl_edge <span class="op">=</span> <span class="cn">T</span>, drop_na <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="plotSurface.html">plotSurface</a></span><span class="op">(</span><span class="va">coords_df</span>, color_by <span class="op">=</span> <span class="st">"dist"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="ggpLayerTissueOutline.html">ggpLayerTissueOutline</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># drop_na = FALSE</span></span>
<span><span class="va">coords_df</span> <span class="op">&lt;-</span> <span class="fu">getCoordsDfSA</span><span class="op">(</span><span class="va">object</span>, ids <span class="op">=</span> <span class="st">"inj1"</span>, incl_edge <span class="op">=</span> <span class="cn">T</span>, drop_na <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="plotSurface.html">plotSurface</a></span><span class="op">(</span><span class="va">coords_df</span>, color_by <span class="op">=</span> <span class="st">"dist"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="ggpLayerTissueOutline.html">ggpLayerTissueOutline</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="ggpLayerSpatAnnOutline.html">ggpLayerSpatAnnOutline</a></span><span class="op">(</span><span class="va">object</span>, ids <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"inj1"</span>, <span class="st">"inj2"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># incl_edge = FALSE (does not make sense in this scenario)</span></span>
<span><span class="va">coords_df</span> <span class="op">&lt;-</span> <span class="fu">getCoordsDfSA</span><span class="op">(</span><span class="va">object</span>, ids <span class="op">=</span> <span class="st">"inj1"</span>, incl_edge <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="plotSurface.html">plotSurface</a></span><span class="op">(</span><span class="va">coords_df</span>, color_by <span class="op">=</span> <span class="st">"dist"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="ggpLayerTissueOutline.html">ggpLayerTissueOutline</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Example 4 - Using external coordinate data.frames</span></span>
<span></span>
<span><span class="co"># get mouse data</span></span>
<span><span class="va">object</span> <span class="op">&lt;-</span> <span class="va">example_data</span><span class="op">$</span><span class="va">object_lmu_mci_diet</span></span>
<span><span class="va">object</span> <span class="op">&lt;-</span> <span class="fu"><a href="identifyTissueOutline.html">identifyTissueOutline</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="va">hemispheres</span> <span class="op">&lt;-</span> <span class="fu"><a href="ggpLayerTissueOutline.html">ggpLayerTissueOutline</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span><span class="va">injuries</span> <span class="op">&lt;-</span> <span class="fu"><a href="ggpLayerSpatAnnOutline.html">ggpLayerSpatAnnOutline</a></span><span class="op">(</span><span class="va">object</span>, ids <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"inj1"</span>, <span class="st">"inj2"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># get sc deconvolution data</span></span>
<span><span class="va">sc_input</span> <span class="op">&lt;-</span> <span class="va">example_data</span><span class="op">$</span><span class="va">sc_input_mci_lmu</span></span>
<span></span>
<span><span class="co"># plot space</span></span>
<span><span class="va">p_visium</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="plotSurface.html">plotSurface</a></span><span class="op">(</span><span class="va">object</span>, <span class="st">"tissue_section"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">hemispheres</span> <span class="op">+</span></span>
<span>  <span class="va">injuries</span></span>
<span></span>
<span><span class="va">p_sc</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="plotSurface.html">plotSurface</a></span><span class="op">(</span><span class="va">sc_input</span>, color_by <span class="op">=</span> <span class="st">"cell_type"</span>, pt_size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">hemispheres</span> <span class="op">+</span></span>
<span>  <span class="va">injuries</span></span>
<span></span>
<span><span class="va">p_visium</span> <span class="op">+</span> <span class="va">p_sc</span></span>
<span></span>
<span><span class="co"># relate cells to spatial annotations</span></span>
<span><span class="va">sc_input_rel</span> <span class="op">&lt;-</span> <span class="fu">getCoordsDfSA</span><span class="op">(</span><span class="va">object</span>, ids <span class="op">=</span> <span class="st">"inj1"</span>, coords_df <span class="op">=</span> <span class="va">sc_input</span>, binwidth <span class="op">=</span> <span class="st">"250um"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="plotSurface.html">plotSurface</a></span><span class="op">(</span><span class="va">sc_input_rel</span>, color_by <span class="op">=</span> <span class="st">"dist"</span>, pt_size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">hemispheres</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">sc_input_rel</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">bins_dist</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">cell_type</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"black"</span>, position <span class="op">=</span> <span class="st">"fill"</span><span class="op">)</span> <span class="op">+</span></span>
<span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span> <span class="fu"><a href="scale_color_add_on.html">scale_color_add_on</a></span><span class="op">(</span>aes <span class="op">=</span> <span class="st">"fill"</span>, variable <span class="op">=</span> <span class="va">sc_input_rel</span><span class="op">$</span><span class="va">cell_type</span>, clrp <span class="op">=</span> <span class="st">"tab20b"</span><span class="op">)</span></span>
<span></span></code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Jan Kueckelhaus, Dieter-Henrik Heiland.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>


<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Plot CNV Heatmap — plotCnvHeatmap • SPATA2</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Plot CNV Heatmap — plotCnvHeatmap"><meta property="og:description" content="Plots the results of runCnvAnalysis() in form of a heatmap.
Use arguments across and across_subset to visualize CNV differences
between subgroups of cluster variables or other grouping variables (e.g. based on
histology created with createSpatialSegmentation())."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SPATA2</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/spata-v2-installation.html">Installation</a>
</li>
<li>
  <a href="../articles/spata-v2-spata-data.html">SPATAData</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li class="dropdown-header">Around the spata2 object</li>
    <li>
      <a href="../articles/spata-v2-object-initiation-and-manipulation.html">Object Set Up and Manipulation</a>
    </li>
    <li>
      <a href="../articles/spata-v2-platform-compatibility.html">Platform Compatibility</a>
    </li>
    <li>
      <a href="../articles/spata-v2-autoencoder.html">Autoencoder</a>
    </li>
    <li>
      <a href="../articles/spata-v2-genes-gene-sets-and-features.html">Genes, Gene Sets and Features</a>
    </li>
    <li class="dropdown-header">Image Analysis</li>
    <li>
      <a href="../articles/spata-v2-image-handling.html">Image Handling</a>
    </li>
    <li>
      <a href="../articles/spata-v2-image-annotations.html">Image Annotations</a>
    </li>
    <li>
      <a href="../articles/spata-v2-spatial-segmentation.html">Spatial Segmentation</a>
    </li>
    <li class="dropdown-header">Analysis of Gene Expression</li>
    <li>
      <a href="../articles/spata-v2-cnv-analysis.html">Copy Number Variations</a>
    </li>
    <li>
      <a href="../articles/spata-v2-clustering.html">Clustering</a>
    </li>
    <li>
      <a href="../articles/spata-v2-dea.html">Differential Expression</a>
    </li>
    <li>
      <a href="../articles/spata-v2-gsea.html">Gene Set Enrichment</a>
    </li>
    <li class="dropdown-header">Expression Gradients &amp; Gradient Screening</li>
    <li>
      <a href="../articles/spata-v2-spatial-trajectories.html">Spatial Trajectories</a>
    </li>
    <li>
      <a href="../articles/spata-v2-spatial-trajectory-screening.html">Spatial Trajectory Screening</a>
    </li>
    <li>
      <a href="../articles/spata-v2-image-annotation-screening.html">Image Annotation Screening</a>
    </li>
    <li>
      <a href="../articles/spata-v2-scd.html">Integrate Single Cell Deconvolution</a>
    </li>
    <li class="dropdown-header">Visualization</li>
    <li>
      <a href="../articles/spata-v2-plotting-surface.html">Surface Plotting</a>
    </li>
    <li>
      <a href="../articles/spata-v2-plotting-misc.html">Miscellaneous</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Code &amp; Concept
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/cc-spatial-measures.html">Spatial Measures</a>
    </li>
    <li>
      <a href="../articles/cc-spatial-segmentation-vs-image-annotations.html">Spatial Segmentation vs. Image Annotations</a>
    </li>
    <li>
      <a href="../articles/cc-spatial-trajectory-screening.html">Spatial Trajectory Screening</a>
    </li>
    <li>
      <a href="../articles/cc-image-annotation-screening.html">Image Annotation Screening</a>
    </li>
    <li>
      <a href="../articles/cc-model-fitting-in-spatial-transcriptomic-studies.html">Model Fitting</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plot CNV Heatmap</h1>
    
    <div class="hidden name"><code>plotCnvHeatmap.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Plots the results of <code><a href="runCnvAnalysis.html">runCnvAnalysis()</a></code> in form of a heatmap.
Use arguments <code>across</code> and <code>across_subset</code> to visualize CNV differences
between subgroups of cluster variables or other grouping variables (e.g. based on
histology created with <code><a href="createSpatialSegmentation.html">createSpatialSegmentation()</a></code>).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">plotCnvHeatmap</span><span class="op">(</span>
  <span class="va">object</span>,
  across <span class="op">=</span> <span class="cn">NULL</span>,
  across_subset <span class="op">=</span> <span class="cn">NULL</span>,
  relevel <span class="op">=</span> <span class="cn">NULL</span>,
  arm_subset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p"</span>, <span class="st">"q"</span><span class="op">)</span>,
  chrom_subset <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">22</span>,
  chrom_separate <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">22</span>,
  chrom_arm_subset <span class="op">=</span> <span class="cn">NULL</span>,
  n_bins_bcsp <span class="op">=</span> <span class="fl">500</span>,
  n_bins_genes <span class="op">=</span> <span class="fl">500</span>,
  summarize_with <span class="op">=</span> <span class="st">"mean"</span>,
  display_arm_annotation <span class="op">=</span> <span class="cn">TRUE</span>,
  colors_arm_annotation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>p <span class="op">=</span> <span class="st">"white"</span>, q <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>,
  display_chrom_annotation <span class="op">=</span> <span class="cn">FALSE</span>,
  display_chrom_names <span class="op">=</span> <span class="cn">TRUE</span>,
  text_alpha <span class="op">=</span> <span class="fl">1</span>,
  text_color <span class="op">=</span> <span class="st">"black"</span>,
  text_position <span class="op">=</span> <span class="st">"top"</span>,
  text_size <span class="op">=</span> <span class="fl">3.5</span>,
  display_hlines <span class="op">=</span> <span class="cn">TRUE</span>,
  hline_alpha <span class="op">=</span> <span class="fl">0.75</span>,
  hline_color <span class="op">=</span> <span class="st">"black"</span>,
  hline_size <span class="op">=</span> <span class="fl">0.5</span>,
  hline_type <span class="op">=</span> <span class="st">"dashed"</span>,
  display_vlines <span class="op">=</span> <span class="cn">TRUE</span>,
  vline_alpha <span class="op">=</span> <span class="fl">0.75</span>,
  vline_color <span class="op">=</span> <span class="st">"black"</span>,
  vline_size <span class="op">=</span> <span class="fl">0.5</span>,
  vline_type <span class="op">=</span> <span class="st">"dashed"</span>,
  display_border <span class="op">=</span> <span class="cn">TRUE</span>,
  border_color <span class="op">=</span> <span class="st">"black"</span>,
  border_size <span class="op">=</span> <span class="fl">0.5</span>,
  clrp <span class="op">=</span> <span class="cn">NULL</span>,
  clrp_adjust <span class="op">=</span> <span class="cn">NULL</span>,
  clrsp <span class="op">=</span> <span class="st">"Blue-Red 3"</span>,
  limits <span class="op">=</span> <span class="cn">NULL</span>,
  annotation_size_top <span class="op">=</span> <span class="fl">0.0125</span>,
  annotation_size_side <span class="op">=</span> <span class="fl">0.0125</span>,
  pretty_name <span class="op">=</span> <span class="cn">TRUE</span>,
  ggpLayers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,
  verbose <span class="op">=</span> <span class="cn">NULL</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>object</dt>
<dd><p>An object of class <code>spata2</code>.</p></dd>


<dt>across</dt>
<dd><p>Character value or NULL. Specifies the grouping variable of interest.</p>
<p>Use <code><a href="getGroupingOptions.html">getGroupingOptions()</a></code> to obtain all variable names that group the
barcode spots of your object in a certain manner.</p></dd>


<dt>across_subset</dt>
<dd><p>Character vector or NULL. Specifies the particular groups
of interest the grouping variable specified in argument <code>across</code> contains.</p>
<p>If set to NULL all of them are chosen. You can prefix groups you are NOT interested in
with a <em>'-'</em>. (Saves writing if there are more groups you are interested in
than groups you are not interested in.)</p>
<p>Use <code><a href="getGroupNames.html">getGroupNames()</a></code> to obtain all valid input options.</p></dd>


<dt>relevel</dt>
<dd><p>Logical value. If set to TRUE the input order of <code>across_subset</code>
determines the order in which the groups of interest are displayed. Groups that
are not included are dropped which affects the colors with which they are displayed.</p></dd>


<dt>arm_subset</dt>
<dd><p>Character vector. A combination of <em>'p'</em> and/or <em>'q'</em>.
Denotes which chromosome arms are included. Defaults to both.</p></dd>


<dt>chrom_subset</dt>
<dd><p>Character or numeric vector. Denotes the chromosomes that
are included. Defaults to all 1-22.</p></dd>


<dt>chrom_separate</dt>
<dd><p>Character or numeric vector. Denotes the chromosomes that
are separated from their neighbors by vertical lines. Defaults to all 1-22. If FALSE or NULL,
no vertical lines are drawn. Requires <code>display_vlines</code> to be set to TRUE.</p></dd>


<dt>chrom_arm_subset</dt>
<dd><p>Character vector. Denotes the exact chromosome-arm combinations
that are included.</p></dd>


<dt>n_bins_bcsp, n_bins_genes</dt>
<dd><p>Numeric values. Denotes the number of bins into which CNV results of
barcode-spot ~ gene pairs are summarized. Reduces the plotting load. Set to <code>Inf</code> if you want
all barcode-spots ~ gene pairs to be plotted in one tile. <code>n_bins_bcsp</code> effectively
specifies the number of rows of the heatmap, <code>n_bins_genes</code> specifies the number of columns.</p></dd>


<dt>summarize_with</dt>
<dd><p>Character value. Name of the function with which to summarize. Either
<em>'mean'</em> or <em>'median'</em>.</p></dd>


<dt>display_arm_annotation</dt>
<dd><p>Logical value. If TRUE, guiding information of the chromosome
arms are plotted on top of the heatmap.</p></dd>


<dt>colors_arm_annotation</dt>
<dd><p>Named character vector. Denotes the colors with which
the chromosome arms are displayed. Names must be <em>'p'</em> and/or <em>'q'</em>.</p></dd>


<dt>display_chrom_annotation</dt>
<dd><p>Logical value. If TRUE, guiding information of the chromosomes
are plotted on top of the heatmap.</p></dd>


<dt>display_chrom_names</dt>
<dd><p>Logical value. If TRUE, the chromosome names/numbers
are plotted on top or on the bottom of the heatmap.</p></dd>


<dt>text_alpha, text_color, text_size</dt>
<dd><p>Parameters given to <code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">ggplot2::geom_text()</a></code>
that are used to manipulate the appearance of the chromosome names.</p></dd>


<dt>text_position</dt>
<dd><p>Character value. Either <em>'top'</em> or <em>'bottom'</em>.</p></dd>


<dt>display_hlines</dt>
<dd><p>Logical value. If TRUE and if <code>across</code> is not NULL,
horizontal lines are drawn to aid the eye by separating the grouping rows of the
heatmap. Appearance of the lines can be adjusted with the <code>hline</code>-arguments.</p></dd>


<dt>hline_alpha, hline_color, hline_size, hline_type</dt>
<dd><p>Parameters given to
<code><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">ggplot2::geom_hline()</a></code> that control the appearance of vertical lines
of the plot.</p></dd>


<dt>display_vlines</dt>
<dd><p>Logical value. If TRUE, vertical lines are drawn to aid the
eye by separating the chromosome columns of the heatmap. Appearance of the lines
can be adjusted with the <code>vlines</code>-arguments.</p></dd>


<dt>vline_alpha, vline_color, vline_size, vline_type</dt>
<dd><p>Parameters given to
<code><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">ggplot2::geom_vline()</a></code> that control the appearance of vertical lines
of the plot.</p></dd>


<dt>display_border</dt>
<dd><p>Logical value. If TRUE, a border is drawn around the heatmap
and each annotation. Can be provided as a named vector to adress single parts
of the heatmap. Valid names are <em>'arm'</em>, <em>'chrom'</em>, <em>'grouping'</em>
and <em>'main'</em>.</p></dd>


<dt>border_color, border_size</dt>
<dd><p>Impact the appearance of the border if <code>display_border</code>
is TRUE.</p></dd>


<dt>clrp</dt>
<dd><p>Character value. Specifies the color palette to be used to represent
groups of discrete variables. Run <code><a href="validActivationFunctions.html">validColorPalettes()</a></code> to obtain valid
input options.</p></dd>


<dt>clrp_adjust</dt>
<dd><p>Named character vector or NULL. If character, it adjusts the
color palette that is used to represent the groups. Names of the input vector must refer
to the group and the respective named element denotes the color with which to
represent the group.</p></dd>


<dt>clrsp</dt>
<dd><p>Character vector. The colorspectrum with which the tiles of the heatmap
are colored. Should be one of <code>validColorSpectra()[[<em>'Diverging'</em>]]</code>.</p></dd>


<dt>limits</dt>
<dd><p>Numeric vector of length two or NULL, If numeric, sets the limits
of the colorscale (<code>oob</code> is set to <code><a href="https://scales.r-lib.org/reference/oob.html" class="external-link">scales::squish</a></code>).</p></dd>


<dt>annotation_size_top, annotation_size_side</dt>
<dd><p>Numeric values. Used to adjust
the size of the row/column annotation of the heatmap.</p></dd>


<dt>pretty_name</dt>
<dd><p>Logical. If TRUE makes legend names pretty.</p></dd>


<dt>ggpLayers</dt>
<dd><p>A list of additional <code>gg</code> elements to customize the
output plot. See details for more.</p></dd>


<dt>verbose</dt>
<dd><p>Logical. If set to TRUE informative messages regarding
the computational progress will be printed.</p>
<p>(Warning messages will always be printed.)</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A plot of class <code>aplot</code>.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The output plot of this function consists of several elements - each element being
a ggplot. These elements are combined/aligned using the <code>aplot</code> package.
Therefore, the output plot is of class <code>aplot</code> and can <b>not</b> be adjusted
by adding additional <code>gg</code> objects using the <code>+</code> operator of the <code>ggplot2</code>
framework.</p>
<p>Individual customization is still possible with the <code>ggpLayers</code> argument.
Every single element of the output plot is named:</p>
<ul><li><p>main: The heatmap itself and the horizontal and vertical lines.</p></li>
<li><p>arm: The arm annotation on top of the heatmap.</p></li>
<li><p>chrom: The chromosome annotation on top of the heatmap. (not displayed by default)</p></li>
<li><p>names: The chromosome name annotation on top of the heatmap.</p></li>
<li><p>grouping: The grouping annotation on the left side of the heatmap if <code>across</code> is not NULL.</p></li>
</ul><p><code>ggpLayers</code> takes a list as input. Unnamed elements of the list are added
to all elements of the plot. E.g.: <code>ggpLayers</code> = <code>list(theme(legend.position = "none"))</code>
removes all legends.</p>
<p>To address single elements of the output plot corresponding elements of the list must be
named. E.g.: <code>ggpLayers</code> = <code>list(grouping = theme(legend.position = "none"))</code>
removes only the legend of the grouping while leaving the legends that come
with other plot elements as they are.</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Jan Kueckelhaus, Dieter-Henrik Heiland, Simon Frerich.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>


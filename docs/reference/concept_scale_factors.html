<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Scale Factors — concept_scale_factors • SPATA2</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Scale Factors — concept_scale_factors"><meta property="og:description" content="With scale factors we refer to numeric values that are used to multiply with the original
x- and y-coordinates of the object's observations, in order to align them
with an image or to bring them into a coordinates system measured in SI units (or both).
Both, S4 class SpatialData and HistoImage contain a slot named @scale_factors.
In both cases it is a named list. If the SPATA2 object contains images, coordinates
of data points or spatial reference features are automatically aligned with the resolution
of the image that is in use, the active image. The required
image scale factor lives in the @scale_factors slot of the HistoImage object which
serves as the container of the respective image.
Furthermore, SPATA2 allows to work with SI units. To transform coordinates from
pixel units to SI units as pixel scale factor is required. Primarily, these
scale factors live in the @scale_factors slot of each registered HistoImage, too.
If the SPATA2 object does not contain images, a pixel scale factor can be stored
in slot @scale_factors of the SpatialData object.
(Generally speaking, whenever scale factors are required the system checks whether
there is an image to which anything must be scaled. If so, the scale factors are
taken from the @scale_factors slot of the HistoImage object. If not, the scale factors
are looked up in the @scale_factors slot of the SpatialData object.)"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SPATA2</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/installation.html">Installation</a>
</li>
<li>
  <a href="../articles/spata-data.html">SPATAData</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tutorials

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li class="dropdown-header">Initiating a SPATA2 object</li>
    <li>
      <a href="../articles/initiation-and-preprocessing-customized.html">Initiation &amp; Preprocessing with individual data</a>
    </li>
    <li>
      <a href="../articles/initiation-and-preprocessing-merfish.html">Initiation &amp; Preprocessing with MERFISH data</a>
    </li>
    <li>
      <a href="../articles/initiation-and-preprocessing-visium.html">Initiation &amp; Preprocessing with Visium data</a>
    </li>
    <li>
      <a href="../articles/initiation-and-preprocessing-visium-hd.html">Initiation &amp; Preprocessing with VisiumHD data</a>
    </li>
    <li class="dropdown-header">Basic Manipulation of a SPATA2 object</li>
    <li>
      <a href="../articles/adding-data.html">Adding Data to SPATA2 objects</a>
    </li>
    <li>
      <a href="../articles/package-compatibility.html">Platform Compatibility</a>
    </li>
    <li>
      <a href="../articles/molecular-variables.html">Molecular Variables</a>
    </li>
    <li>
      <a href="../articles/image-handling.html">Image Handling</a>
    </li>
    <li>
      <a href="../articles/spatial-segmentation.html">Spatial Segmentation</a>
    </li>
    <li class="dropdown-header">Implemented Algorithms &amp; Concepts</li>
    <li>
      <a href="../articles/cnv.html">Copy Number Variations</a>
    </li>
    <li>
      <a href="../articles/clustering.html">Clustering</a>
    </li>
    <li>
      <a href="../articles/dimensional-reduction.html">Dimensional Reduction</a>
    </li>
    <li>
      <a href="../articles/dea.html">Differential Expression</a>
    </li>
    <li>
      <a href="../articles/gsea.html">Gene Set Enrichment</a>
    </li>
    <li>
      <a href="../articles/spatial-measures.html">Spatial Measures</a>
    </li>
    <li class="dropdown-header">Spatial Gradient Screening</li>
    <li>
      <a href="../articles/creating-spatial-annotations.html">Creating Spatial Annotations</a>
    </li>
    <li>
      <a href="../articles/using-spatial-annotations.html">Using Spatial Annotations</a>
    </li>
    <li>
      <a href="../articles/spatial-annotation-screening.html">Spatial Annotation Screening</a>
    </li>
    <li>
      <a href="../articles/creating-spatial-trajectories.html">Creating Spatial Trajectories</a>
    </li>
    <li>
      <a href="../articles/spatial-trajectory-screening.html">Spatial Trajectory Screening</a>
    </li>
    <li class="dropdown-header">Visualization</li>
    <li>
      <a href="../articles/plotting-surface.html">Surface Plotting</a>
    </li>
  </ul></li>
<li>
  <a href="../articles/newslog.html">Newslog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Scale Factors</h1>

    <div class="hidden name"><code>concept_scale_factors.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>With scale factors we refer to numeric values that are used to multiply with the original
x- and y-coordinates of the object's observations, in order to align them
with an image or to bring them into a coordinates system measured in SI units (or both).</p>
<p>Both, S4 class <code><a href="SpatialData-class.html">SpatialData</a></code> and <code><a href="HistoImage-class.html">HistoImage</a></code> contain a slot named @scale_factors.
In both cases it is a named list. If the <code>SPATA2</code> object contains images, coordinates
of data points or spatial reference features are automatically aligned with the resolution
of the image that is in use, the <code><a href="concept_images.html">active image</a></code>. The required
<em>image scale factor</em> lives in the @scale_factors slot of the <code><a href="HistoImage-class.html">HistoImage</a></code> object which
serves as the container of the respective image.</p>
<p>Furthermore, SPATA2 allows to work with SI units. To transform coordinates from
pixel units to SI units as <em>pixel scale factor</em> is required. Primarily, these
scale factors live in the @scale_factors slot of each registered <code><a href="HistoImage-class.html">HistoImage</a></code>, too.
If the <code><a href="SPATA2.html">SPATA2</a></code> object does not contain images, a pixel scale factor can be stored
in slot @scale_factors of the <code><a href="SpatialData-class.html">SpatialData</a></code> object.</p>
<p>(Generally speaking, whenever scale factors are required the system checks whether
there is an image to which anything must be scaled. If so, the scale factors are
taken from the @scale_factors slot of the <code>HistoImage</code> object. If not, the scale factors
are looked up in the @scale_factors slot of the <code>SpatialData</code> object.)</p>
    </div>


    <div id="image-alignment-scale-factor-image">
    <h2>Image alignment - scale factor <em>image</em></h2>


<p><code><a href="SPATA2.html">SPATA2</a></code> objects allow to store multiple images simultaneously and
as they might differ in resolutions, different scale factors are required to scale
the coordinates of the observations appropriately, such that image and coordinates
align perfectly. This is what happens in the background when you extract or plot
the observations in the light of the resolution of a fictional example image <em>lowres_image</em>.</p>
<p>First, the original data.frame is obtained.
<code>coords_df &lt;- getCoordsDf(object, as_is = TRUE)</code></p>
<p>Second, the image scale factor of image 'lowres_image' is extracted.
<code>csf &lt;- getScaleFactor(object, img_name = "lowres_image", fct_name = "image")</code></p>
<p>Third, the variables are transformed to x and y.
<code>coords_df$x &lt;- coords_df$x_orig * csf</code></p>
<p><code>coords_df$y &lt;- coords_df$y_orig * csf</code></p>
<p>The same process is applied to any sort of spatial data upon extraction, e.g.
<code><a href="getSpatAnnOutlineDf.html">getSpatAnnOutlineDf()</a></code>.</p>
<p>If the object does <strong>not</strong> contain an image, e.g. for <code><a href="MERFISH.html">MERFISH</a></code> or <code><a href="Xenium.html">Xenium</a></code>,
there are no images and thus slot @images of the <code>SpatialData</code> object is empty.
Furthermore, since there is nothing to align, there is no <em>image</em> scale factor.
In that case <em>x</em> and <em>y</em> variables of the data.frame will be equal
to <em>x_orig</em> and <em>y_orig</em>.</p>
    </div>
    <div id="si-units-scale-factor-pixel">
    <h2>SI units - scale factor <em>pixel</em></h2>


<p>The pixel scale factor is used to transform the coordinates from pixel to SI units.
It is a numeric value that comes with an attribute which indicates the SI unit to
which the pixel value is scaled (e.g. mm / px). It is applied <strong>after</strong> the coordinates
have been scaled to the image resolution.</p>
<p><code>coords_df &lt;- getCoordsDf(object)</code></p>
<p><code>psf &lt;- getPixelScaleFactor(object)</code></p>
<p><code>coords_df$x_si &lt;- coords_df$x * psf</code></p>
<p><code>coords_df$y_si &lt;- coords_df$y * psf</code></p>
<p>Note: Methods that do not include an image, often provide the coordinates already
in SI units. <code><a href="MERFISH.html">MERFISH</a></code> coordinates, for instance, are already in micrometer units.
The <em>pixel</em> scale factor therefore is <em>1um/px</em>.</p>
<p>(The name <em>pixel scale factor</em> has evolved historically, since SPATA2 was developed
with the Visium platform in mind. It does not fit perfectly for platforms such as
<code><a href="MERFISH.html">MERFISH</a></code> or <code><a href="Xenium.html">Xenium</a></code> experiments since they do not provide an image. But
the SI unit system of SPATA2 works stable and we don't want to touch it. Therefore,
the name remains.)</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Jan Kueckelhaus, Dieter-Henrik Heiland.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

